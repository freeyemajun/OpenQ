<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux 主机安装 | DiscuzQ 安装文档</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>
      document.addEventListener("DOMContentLoaded", function(){
        console.log("ready");
        var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && isChrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                var element_to_scroll_to = document.getElementById(decodeURI(hash.substr(1)));
                element_to_scroll_to.scrollIntoView();
            }, 300);
        }
      });
</script>
    <meta name="description" content="">
    
    <link rel="preload" href="/docs/assets/css/0.styles.1dac2540.css" as="style"><link rel="preload" href="/docs/assets/js/app.4a94bff3.js" as="script"><link rel="preload" href="/docs/assets/js/2.65b3c0ea.js" as="script"><link rel="preload" href="/docs/assets/js/1.93f47670.js" as="script"><link rel="preload" href="/docs/assets/js/40.a7c7edfd.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e303b1fe.js"><link rel="prefetch" href="/docs/assets/js/11.caa9adf9.js"><link rel="prefetch" href="/docs/assets/js/12.f47f63d5.js"><link rel="prefetch" href="/docs/assets/js/13.93dc81ea.js"><link rel="prefetch" href="/docs/assets/js/14.704d1a26.js"><link rel="prefetch" href="/docs/assets/js/15.2330e6dc.js"><link rel="prefetch" href="/docs/assets/js/16.6aaa40a5.js"><link rel="prefetch" href="/docs/assets/js/17.e32a5229.js"><link rel="prefetch" href="/docs/assets/js/18.1fa05986.js"><link rel="prefetch" href="/docs/assets/js/19.53f57844.js"><link rel="prefetch" href="/docs/assets/js/20.864577f6.js"><link rel="prefetch" href="/docs/assets/js/21.b4e831fa.js"><link rel="prefetch" href="/docs/assets/js/22.243f8c8f.js"><link rel="prefetch" href="/docs/assets/js/23.7addb889.js"><link rel="prefetch" href="/docs/assets/js/24.ef0496a7.js"><link rel="prefetch" href="/docs/assets/js/25.89b549f4.js"><link rel="prefetch" href="/docs/assets/js/26.0a614c82.js"><link rel="prefetch" href="/docs/assets/js/27.c737aa41.js"><link rel="prefetch" href="/docs/assets/js/28.1e6bd7b4.js"><link rel="prefetch" href="/docs/assets/js/29.3f95441b.js"><link rel="prefetch" href="/docs/assets/js/3.640e72c3.js"><link rel="prefetch" href="/docs/assets/js/30.778c4be0.js"><link rel="prefetch" href="/docs/assets/js/31.7bb18d07.js"><link rel="prefetch" href="/docs/assets/js/32.ace851f7.js"><link rel="prefetch" href="/docs/assets/js/33.80a8af0e.js"><link rel="prefetch" href="/docs/assets/js/34.d85fff39.js"><link rel="prefetch" href="/docs/assets/js/35.3adf9801.js"><link rel="prefetch" href="/docs/assets/js/36.9a107e60.js"><link rel="prefetch" href="/docs/assets/js/37.6d5ed231.js"><link rel="prefetch" href="/docs/assets/js/38.d4773946.js"><link rel="prefetch" href="/docs/assets/js/39.1f25f111.js"><link rel="prefetch" href="/docs/assets/js/4.6fcba847.js"><link rel="prefetch" href="/docs/assets/js/41.6c906a58.js"><link rel="prefetch" href="/docs/assets/js/42.19af8c9b.js"><link rel="prefetch" href="/docs/assets/js/43.c3501ba2.js"><link rel="prefetch" href="/docs/assets/js/44.095b6352.js"><link rel="prefetch" href="/docs/assets/js/45.f712c735.js"><link rel="prefetch" href="/docs/assets/js/46.ea4a5f90.js"><link rel="prefetch" href="/docs/assets/js/47.4c923c28.js"><link rel="prefetch" href="/docs/assets/js/48.a2893909.js"><link rel="prefetch" href="/docs/assets/js/49.4c0fc68d.js"><link rel="prefetch" href="/docs/assets/js/5.5755b19e.js"><link rel="prefetch" href="/docs/assets/js/50.a768c789.js"><link rel="prefetch" href="/docs/assets/js/51.9145a08d.js"><link rel="prefetch" href="/docs/assets/js/52.bea51864.js"><link rel="prefetch" href="/docs/assets/js/53.d24412c9.js"><link rel="prefetch" href="/docs/assets/js/54.cd9f37d4.js"><link rel="prefetch" href="/docs/assets/js/55.a856d50b.js"><link rel="prefetch" href="/docs/assets/js/56.b3072981.js"><link rel="prefetch" href="/docs/assets/js/57.e9c27eb6.js"><link rel="prefetch" href="/docs/assets/js/58.a94f49c6.js"><link rel="prefetch" href="/docs/assets/js/59.76707aea.js"><link rel="prefetch" href="/docs/assets/js/6.c1859e2f.js"><link rel="prefetch" href="/docs/assets/js/60.79251db4.js"><link rel="prefetch" href="/docs/assets/js/61.742230c8.js"><link rel="prefetch" href="/docs/assets/js/62.ca1bb933.js"><link rel="prefetch" href="/docs/assets/js/63.75830b2e.js"><link rel="prefetch" href="/docs/assets/js/64.243cb0d7.js"><link rel="prefetch" href="/docs/assets/js/7.d29ddd45.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.d97d6166.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.1dac2540.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">DiscuzQ 安装文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  返回
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  返回
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>安装</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/安装/Windows 主机.html" class="sidebar-link">Windows 主机安装</a></li><li><a href="/docs/安装/Linux 主机.html" class="active sidebar-link">Linux 主机安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#基于手动配置的环境" class="sidebar-link">基于手动配置的环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#apache" class="sidebar-link">Apache</a></li><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#nginx" class="sidebar-link">Nginx</a></li><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#caddy" class="sidebar-link">Caddy</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#基于宝塔" class="sidebar-link">基于宝塔</a></li><li class="sidebar-sub-header"><a href="/docs/安装/Linux 主机.html#基于-docker-容器-推荐" class="sidebar-link">基于 Docker 容器 （推荐）</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>使用</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>升级和转换</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linux-主机安装"><a href="#linux-主机安装" class="header-anchor">#</a> Linux 主机安装</h1> <h2 id="基于手动配置的环境"><a href="#基于手动配置的环境" class="header-anchor">#</a> 基于手动配置的环境</h2> <h3 id="apache"><a href="#apache" class="header-anchor">#</a> Apache</h3> <h4 id="操作场景"><a href="#操作场景" class="header-anchor">#</a> 操作场景</h4> <p>本文档将指导您如何在已安装 Apache 服务的 Linux 服务器上安装部署 Discuz! Q。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>若您已知晓如何安装部署 Discuz! Q，您可以直接<a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer">单击此处<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载 Discuz! Q 进行安装部署。</li> <li>本文档以 Apache 2.4.46 版本、PHP 7.3.23、 CentOS 7.6 为例。</li></ul></div> <h4 id="前提条件"><a href="#前提条件" class="header-anchor">#</a> 前提条件</h4> <ul><li>服务器已安装的 PHP 版本为 7.2.5 及以上(暂不推荐使用7.4)，数据库使用 MySQL 5.7.9 版本以上或 MariaDB 10.2 以上。</li> <li>已成功登录 Linux 服务器。</li></ul> <h4 id="操作步骤"><a href="#操作步骤" class="header-anchor">#</a> 操作步骤</h4> <h4 id="步骤一-配置php"><a href="#步骤一-配置php" class="header-anchor">#</a> 步骤一：配置PHP</h4> <h4 id="安装扩展"><a href="#安装扩展" class="header-anchor">#</a> 安装扩展</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz! Q 依赖于 <code>BCMath</code> <code>Ctype</code> <code>Curl</code> <code>Dom</code> <code>Fileinfo</code> <code>GD</code> <code>JSON</code> <code>Mbstring</code> <code>Exif</code> <code>OpenSSL</code> <code>PDO</code> <code>PDO_mysql</code> <code>Tokenizer</code> <code>XML</code> <code>Zip</code>扩展插件，在 PHP 中需开启以上扩展。</li> <li>以下操作因为系统版本，软件版本的不同，操作上会有所差异，请根据您的具体情况进行开启对应函数，以下操作仅提供示例。</li></ul></div> <ol><li><p>查看 PHP 已安装扩展。在终端中，可以输入 <code>php -m</code> 查看已安装扩展。</p></li> <li><p>安装缺失扩展。在终端中，您可以根据查询结果安装对应缺失的扩展。</p> <ul><li>如缺失 <code>Exif</code> 扩展，可以使用以下命令进行编译安装扩展 <code>Exif</code>扩展。</li></ul></li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>以下路径仅提供示例。请根据实际情况进行输入。</p></div> <div class="language- extra-class"><pre class="language-text"><code># 使用 cd 命令进入 php 的源码的 exif 模块目录。
cd /root/lamp1.7/src/php-7.3.23/ext/exif/

# 执行 phpize 脚本。
/usr/local/php/bin/phpize

# 编译配置。
./configure --with-php-config=/usr/local/php/bin/php-config

# 编译安装 exif 模块。
make &amp;&amp; make install
</code></pre></div><ol><li>配置<code>php.ini</code>文件。可在终端中输入<code>php --ini</code>查看<code>php.ini</code>配置文件路径。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/149f2f45d6c305fa8710fe265c6be57d.png" alt=""></p> <ol start="2"><li>您可通过<code>vim</code>命令，或使用 WinSCP 工具，根据查询到的文件路径，打开<code>php.ini</code>文件。</li> <li>编辑<code>php.ini</code> 文件，去掉以下字段前面的<code>;</code>分号，并保存<code>php.ini</code> 文件。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>extension=exif    
exif.encode_unicode = ISO-8859-15
exif.decode_unicode_motorola = UCS-2BE
exif.decode_unicode_intel    = UCS-2LE
exif.encode_jis =
exif.decode_jis_motorola = JIS
exif.decode_jis_intel    = JIS=
</code></pre></div><ol start="4"><li>重启 PHP 与 Apache 服务。</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>您可参考命令<code>service php-fpm restart</code>与 <code>service httpd restart</code>重启 PHP 与 Apache 服务。</p></div> <h4 id="启用-php-函数"><a href="#启用-php-函数" class="header-anchor">#</a> 启用 PHP 函数</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz！Q 依赖于 <code>symlink</code>、<code>readlink</code>、<code>putenv</code>、<code>realpath</code>、<code>shell_exec</code> 函数，在PHP中需开启以上函数。</li> <li>以下操作因为系统版本，软件版本的不同，操作上和命令上会有所差异，请根据您的具体情况开启 <code>mod_rewrite</code> ，以下操作仅提供示例。</li></ul></div> <ol><li>打开并编辑 <code>php.ini</code>文件。查找 <code>disable_functions</code>字段，并删除禁用掉的<code>symlink</code>、<code>readlink</code>、 <code>putenv</code>、 <code>realpath</code>、<code>shell_exec</code> 函数。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>disable_functions = passthru,exec,system,chroot,chgrp,chown,shell_exec,proc_open,proc_get_status,popen,ini_alter,ini_restore,dl,openlog,syslog,popepassthru,stream_socket_server
</code></pre></div><ol start="2"><li>保存 <code>php.ini</code>文件。</li> <li>重启 PHP 与 Apache 服务。</li></ol> <h4 id="步骤二-配置-apache"><a href="#步骤二-配置-apache" class="header-anchor">#</a> 步骤二：配置 Apache</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz！Q 依赖于 <code>mod_rewrite</code> 模块。请确保已经启用 <code>mod_rewrite</code>，以下操作将指导您启动 <code>mod_rewrite</code>。</li> <li>以下操作因为系统版本，软件版本的不同，操作上和命令上会有所差异，请根据您的具体情况开启 <code>mod_rewrite</code> ，以下操作仅提供示例。</li></ul></div> <h4 id="启用-mod-rewrite"><a href="#启用-mod-rewrite" class="header-anchor">#</a> 启用 mod_rewrite</h4> <ol><li>检查 <code>mod_rewrite</code> 是否启用。您可以在终端中输入 <code>httpd -M</code> 查看已安装模块。</li> <li>如果查询结果中无 <code>rewrite_module</code> 字段，您可以在 <code>conf</code> 目录的 <code>httpd.conf</code> 文件中，查找以下字段，并去掉字段前<code>#</code> 符号。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>LoadModule rewrite_module modules/mod_rewrite.so
</code></pre></div><ol start="3"><li>定位到 <code>&lt;directory /&gt;</code> 字段，并修改内容为如下内容：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;directory /&gt;
        Options All
        AllowOverride All
        DirectoryIndex index.php index.html
&lt;/directory&gt;
</code></pre></div><ol start="4"><li>重启 Apache 服务。</li></ol> <h4 id="步骤三-下载并解压-discuz-q-安装包"><a href="#步骤三-下载并解压-discuz-q-安装包" class="header-anchor">#</a> 步骤三：下载并解压 Discuz！Q 安装包</h4> <ol><li>您可以通过以下命令在网站主目录下创建 Discuz！Q 网站目录，并下载 Discuz！Q 安装包与解压。</li></ol> <div class="language- extra-class"><pre class="language-text"><code># 创建Discuz！Q 网站目录，目录名可自定义，此处以 discuz 为例。
mkdir discuz

# 进入 discuz 目录
cd discuz

# 下载 Discuz！Q 安装包
wget -c https://discuzq.icu

# 解压 Discuz！Q 安装包
unzip dzq_latest_install.zip
</code></pre></div><h4 id="步骤四-初始化安装-discuz-q"><a href="#步骤四-初始化安装-discuz-q" class="header-anchor">#</a> 步骤四：初始化安装 Discuz! Q</h4> <ol><li>打开本地浏览器，访问 <code>http://&lt;绑定网站的域名名称&gt;/install</code> 。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/d571ed3234565af42c508666b827ca37.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>站点如需部署 SSL 证书，使用 HTTPS 协议进行站点访问。请在以下操作之前部署安装 SSL 证书，并使用<code>https://&lt;绑定网站的域名名称&gt;/install</code>  进行访问。部署安装 SSL 证书详情操作请参考： <a href="https://cloud.tencent.com/document/product/400/35244" target="_blank" rel="noopener noreferrer">Nginx 服务器证书安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>如需购买 SSL 证书，可参考 <a href="https://cloud.tencent.com/document/product/400/7995" target="_blank" rel="noopener noreferrer">SSL 证书购买流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，请根据您的实际情况进行购买相关证书。腾讯云为 Discuz! Q 站点提供免费 SSL 证书申请。详情请查看：<a href="https://cloud.tencent.com/document/product/400/6814" target="_blank" rel="noopener noreferrer">域名型（DV）免费证书申请流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <ol start="2"><li><p>单击【下一步】，Discuz! Q 将自行进行站点检查。如有报错等问题，可参考 <a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html" target="_blank" rel="noopener noreferrer">常见问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行排查处理。</p></li> <li><p>Discuz! Q 检查完成后，需配置网站相关信息。如下图所示：</p></li></ol> <p><img src="https://main.qcloudimg.com/raw/8e3ac52669180620b946750787b50c95.png" alt=""></p> <ul><li><strong>站点名称</strong>：请输入您的站点名称信息，可自定义。</li> <li><strong>MySQL 服务器地址</strong>：请输入您的 MySQL 服务器地址。</li> <li><strong>数据库名称</strong>：请输入您的数据库名称。</li> <li><strong>MySQL 用户名</strong>：请输入您的数据库用户名。</li> <li><strong>MySQL 密码</strong>：请输入您的数据库密码。</li> <li><strong>表前缀</strong>：可选，可自定义数据库表前缀名称。默认不填。</li> <li><strong>设置管理员用户名</strong>：请输入您 Discuz! Q 站点的管理员用户名。</li> <li><strong>设置管理员密码</strong>：请输入您 Discuz! Q 站点的管理员密码。</li> <li><strong>管理员密码确认</strong>：请再次输入您 Discuz! Q 站点的管理员密码。</li></ul> <ol start="4"><li>单击【下一步】。即可完成 DIscuz！Q 的安装部署。</li></ol> <h4 id="步骤五-添加计划任务"><a href="#步骤五-添加计划任务" class="header-anchor">#</a> 步骤五：添加计划任务</h4> <p>为保证 DIscuz！Q 站点功能的正常使用。您还需要在服务器添加计划任务。在终端中输入以下命令并执行。</p> <div class="language- extra-class"><pre class="language-text"><code>php &lt;网站主目录&gt;/disco schedule:run &gt;&gt; /dev/null 2&gt;&amp;1
</code></pre></div><h3 id="nginx"><a href="#nginx" class="header-anchor">#</a> Nginx</h3> <h4 id="操作场景-2"><a href="#操作场景-2" class="header-anchor">#</a> 操作场景</h4> <p>本文档将指导您如何在已安装 Nginx 服务的 Linux 服务器上安装部署 Discuz! Q。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>若您已知晓如何安装部署 Discuz! Q，您可以直接<a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer">单击此处<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载 Discuz! Q 进行安装部署。</li> <li>本文档以 Nginx 1.18.0 版本、PHP 7.3.23  、CentOS 7.6 为例。</li></ul></div> <h4 id="前提条件-2"><a href="#前提条件-2" class="header-anchor">#</a> 前提条件</h4> <ul><li>服务器已安装的 PHP 版本为 7.2.5 及以上(暂不推荐使用7.4)，数据库使用 MySQL 5.7.9 版本以上或MariaDB 10.2以上。</li> <li>已成功登录 Linux 服务器。</li></ul> <h4 id="操作步骤-2"><a href="#操作步骤-2" class="header-anchor">#</a> 操作步骤</h4> <h4 id="步骤一-配置php-2"><a href="#步骤一-配置php-2" class="header-anchor">#</a> 步骤一：配置PHP</h4> <h4 id="安装扩展-2"><a href="#安装扩展-2" class="header-anchor">#</a> 安装扩展</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz! Q 依赖于 <code>BCMath</code> <code>Ctype</code> <code>Curl</code> <code>Dom</code> <code>Fileinfo</code> <code>GD</code> <code>JSON</code> <code>Mbstring</code> <code>Exif</code> <code>OpenSSL</code> <code>PDO</code> <code>PDO_mysql</code> <code>Tokenizer</code> <code>XML</code> <code>Zip</code>扩展插件，在 PHP 中需开启以上扩展。</li> <li>以下操作因为系统版本，软件版本的不同，操作上会有所差异，请根据您的具体情况进行开启对应扩展，以下操作仅提供示例。</li></ul></div> <ol><li>查看 php 已安装扩展。在终端中，可以输入<code>php -m</code>查看已安装扩展。</li> <li>安装缺失扩展。在终端中，您可以根据查询结果安装对应缺失的扩展。
<ul><li>如缺失<code>Exif</code>扩展。可以使用以下命令进行编译安装扩展 <code>Exif</code>扩展。</li></ul></li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>以下路径仅提供示例。请根据实际情况进行输入。</p></div> <div class="language- extra-class"><pre class="language-text"><code># 使用 cd 命令进入 php 的源码的exif模块目录。
cd /root/lnmp1.7/src/php-7.3.23/ext/exif/

# 执行 phpize 脚本。
/usr/local/php/bin/phpize

# 编译配置。
./configure --with-php-config=/usr/local/php/bin/php-config

# 编译安装 exif 模块。
make &amp;&amp; make install
</code></pre></div><ol><li>配置<code>php.ini</code>文件。可在终端中输入<code>php --ini</code>查看<code>php.ini</code>配置文件路径。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/149f2f45d6c305fa8710fe265c6be57d.png" alt=""></p> <ol start="2"><li>您可通过<code>vim</code>命令，或使用 WinSCP 工具，根据查询到的文件路径，打开<code>php.ini</code>文件。</li> <li>编辑<code>php.ini</code> 文件，去掉以下字段前面的<code>;</code>分号，并保存<code>php.ini</code> 文件。如下所示</li></ol> <div class="language- extra-class"><pre class="language-text"><code>extension=exif    
exif.encode_unicode = ISO-8859-15
exif.decode_unicode_motorola = UCS-2BE
exif.decode_unicode_intel    = UCS-2LE
exif.encode_jis =
exif.decode_jis_motorola = JIS
exif.decode_jis_intel    = JIS=
</code></pre></div><ol start="3"><li>重启 PHP 与 Nginx 服务。<div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>您可以参考<code>service php-fpm restart</code>与 <code>nginx -s reload</code>命令重启 PHP 与 Nginx 服务。</p></div></li></ol> <h4 id="步骤二-安装-php-函数"><a href="#步骤二-安装-php-函数" class="header-anchor">#</a> 步骤二:安装 PHP 函数</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz! Q 依赖于<code>symlink</code>、<code>readlink</code>、 <code>putenv</code>、 <code>realpath</code>、<code>shell_exec</code>函数，在PHP中需开启以上函数。</li> <li>以下操作因为系统版本，软件版本的不同，操作上会有所差异，请根据您的具体情况进行开启对应函数，以下操作仅提供示例。</li></ul></div> <ol><li>打开并编辑 <code>php.ini</code>文件。查找 <code>disable_functions</code>字段，并删除禁用掉的<code>symlink</code>、<code>readlink</code>、 <code>putenv</code>、 <code>realpath</code>、<code>shell_exec</code> 函数。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>disable_functions = passthru,exec,system,chroot,chgrp,chown,shell_exec,proc_open,proc_get_status,popen,ini_alter,ini_restore,dl,openlog,syslog,popepassthru,stream_socket_server
</code></pre></div><ol start="2"><li>保存 <code>php.ini</code>文件。</li> <li>重启 PHP 与 Nginx 服务。</li></ol> <h4 id="步骤三-下载并解压-discuz-q-安装包-2"><a href="#步骤三-下载并解压-discuz-q-安装包-2" class="header-anchor">#</a> 步骤三：下载并解压 Discuz！Q 安装包</h4> <ol><li>您可以通过以下命令在网站主目录下创建 Discuz！Q 网站目录，下载 Discuz！Q 安装包与解压。</li></ol> <div class="language- extra-class"><pre class="language-text"><code># 创建Discuz！Q 网站目录，目录名可自定义，此处以discuz为例。
mkdir discuz

#进入 discuz目录
cd discuz

#下载Discuz！Q 安装包
wget -c https://discuzq.icu

#解压 Discuz！Q 安装包
unzip dzq_latest_install.zip
</code></pre></div><h4 id="步骤四-配置-nginx"><a href="#步骤四-配置-nginx" class="header-anchor">#</a> 步骤四：配置 Nginx</h4> <ol><li>查看 <code>nginx</code> 配置文件。您可以使用 <code>nginx -t</code> 命令查看 <code>nginx.conf</code> 配置文件路径。如下所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/b4cfcbe58fd61b5d79e2e0af64cb5a35.png" alt=""></p> <ol start="2"><li>您可通过 <code>vim</code> 命令，或使用 WinSCP 工具，打开 <code>nginx.conf</code> 配置文件进行以下配置。</li></ol> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Nginx 必须包含以下配置。</p></div> <p>请将<code>root</code>目录指向 <code>&lt;站点主目录&gt;/public</code>目录，同时一定要配置<code>index</code>和 <code>location /</code>，将所有的请求将引导到 <code>index.php</code> 。具体配置请参考如下：</p> <h4 id="root-配置"><a href="#root-配置" class="header-anchor">#</a> root 配置</h4> <p>请确认 <code>root</code> 指向了安装好的 <code>public</code>目录，以下是示例，请按自己的实际配置设置。</p> <div class="language- extra-class"><pre class="language-text"><code>root /home/www/discuz/public;
</code></pre></div><h4 id="index-配置"><a href="#index-配置" class="header-anchor">#</a> index 配置</h4> <p>请确认 index 的第一项是 index.php ，以下为示例。</p> <div class="language- extra-class"><pre class="language-text"><code>index index.php index.html;
</code></pre></div><h4 id="location-配置"><a href="#location-配置" class="header-anchor">#</a> location 配置</h4> <p>请确认 location / 按如下配置，如果之前有相关配置，请替换：</p> <div class="language- extra-class"><pre class="language-text"><code>    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }
</code></pre></div><h4 id="nginx-建议配置"><a href="#nginx-建议配置" class="header-anchor">#</a> Nginx 建议配置</h4> <p>建议添加以下配置，以启用 gzip 压缩,减少服务器资源损耗。</p> <div class="language- extra-class"><pre class="language-text"><code>  gzip on;
  gzip_min_length 1024;
  gzip_types application/json text/html text/css application/x-javascript application/javascript application/vnd.api+json;
  gzip_disable &quot;MSIE [1-6]\.&quot;;
  gzip_comp_level 2;
</code></pre></div><h4 id="步骤五-初始化安装-discuz-q"><a href="#步骤五-初始化安装-discuz-q" class="header-anchor">#</a> 步骤五：初始化安装 Discuz! Q</h4> <ol><li>打开本地浏览器，访问 <code>http://&lt;绑定网站的域名名称&gt;/install</code> 。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/d571ed3234565af42c508666b827ca37.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>站点如需部署 SSL 证书，使用 HTTPS 协议进行站点访问。请在以下操作之前部署安装 SSL 证书，并使用<code>https://&lt;绑定网站的域名名称&gt;/install</code>  进行访问。部署安装 SSL 证书详情操作请参考： <a href="https://cloud.tencent.com/document/product/400/35244" target="_blank" rel="noopener noreferrer">Nginx 服务器证书安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>如需购买 SSL 证书，可参考 <a href="https://cloud.tencent.com/document/product/400/7995" target="_blank" rel="noopener noreferrer">SSL 证书购买流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，请根据您的实际情况进行购买相关证书。腾讯云为 Discuz! Q 站点提供免费 SSL 证书申请。详情请查看：<a href="https://cloud.tencent.com/document/product/400/6814" target="_blank" rel="noopener noreferrer">域名型（DV）免费证书申请流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <ol start="2"><li><p>单击【下一步】，Discuz! Q 将自行进行站点检查。如有报错等问题，可参考 <a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html" target="_blank" rel="noopener noreferrer">常见问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行排查处理。</p></li> <li><p>Discuz! Q 检查完成后，需配置网站相关信息。如下图所示：</p></li></ol> <p><img src="https://main.qcloudimg.com/raw/8e3ac52669180620b946750787b50c95.png" alt=""></p> <ul><li><strong>站点名称</strong>：请输入您的站点名称信息，可自定义。</li> <li><strong>MySQL 服务器地址</strong>：请输入您的 MySQL 服务器地址。</li> <li><strong>数据库名称</strong>：请输入您的数据库名称。</li> <li><strong>MySQL 用户名</strong>：请输入您的数据库用户名。</li> <li><strong>MySQL 密码</strong>：请输入您的数据库密码。</li> <li><strong>表前缀</strong>：可选，可自定义数据库表前缀名称。默认不填。</li> <li><strong>设置管理员用户名</strong>：请输入您 Discuz! Q 站点的管理员用户名。</li> <li><strong>设置管理员密码</strong>：请输入您 Discuz! Q 站点的管理员密码。</li> <li><strong>管理员密码确认</strong>：请再次输入您 Discuz! Q 站点的管理员密码。</li></ul> <ol start="4"><li>单击【下一步】。即可完成 DIscuz！Q 的安装部署。</li></ol> <h4 id="步骤六-添加计划任务"><a href="#步骤六-添加计划任务" class="header-anchor">#</a> 步骤六：添加计划任务</h4> <p>为保证 DIscuz！Q 站点功能的正常使用。您还需要在服务器添加计划任务。在终端中输入以下命令并执行。</p> <div class="language- extra-class"><pre class="language-text"><code>php &lt;网站主目录&gt;/disco schedule:run &gt;&gt; /dev/null 2&gt;&amp;1
</code></pre></div><h3 id="caddy"><a href="#caddy" class="header-anchor">#</a> Caddy</h3> <h4 id="操作场景-3"><a href="#操作场景-3" class="header-anchor">#</a> 操作场景</h4> <p>本文档将指导您如何在已安装 Caddy 的 Linux 服务器上安装部署 Discuz! Q。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>若您已知晓如何安装部署 Discuz! Q，您可以直接<a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer">单击此处<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载 Discuz! Q 进行安装部署。</li> <li>本文档以 Caddy 2.2.1 、PHP 7.3.25 、 CentOS 7.6 版本为例。</li></ul></div> <h4 id="前提条件-3"><a href="#前提条件-3" class="header-anchor">#</a> 前提条件</h4> <ul><li>服务器已安装的 PHP 版本为 7.2.5 及以上(暂不推荐使用7.4)，数据库使用 MySQL 5.7.9 版本以上或 MariaDB 10.2 以上。</li> <li>已成功登录 Linux 服务器。</li></ul> <h4 id="操作步骤-3"><a href="#操作步骤-3" class="header-anchor">#</a> 操作步骤</h4> <h4 id="步骤一-配置-php"><a href="#步骤一-配置-php" class="header-anchor">#</a> 步骤一：配置 PHP</h4> <h4 id="安装扩展-3"><a href="#安装扩展-3" class="header-anchor">#</a> 安装扩展</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz! Q 依赖于 <code>BCMath</code> <code>Ctype</code> <code>Curl</code> <code>Dom</code> <code>Fileinfo</code> <code>GD</code> <code>JSON</code> <code>Mbstring</code> <code>Exif</code> <code>OpenSSL</code> <code>PDO</code> <code>PDO_mysql</code> <code>Tokenizer</code> <code>XML</code> <code>Zip</code> 扩展插件，在 PHP 中需开启以上扩展。</li> <li>以下操作因为系统版本，软件版本的不同，操作上会有所差异，请根据您的具体情况进行开启对应扩展，以下操作仅提供示例。</li></ul></div> <ol><li>查看 <code>php</code> 已安装扩展。在终端中，可以输入 <code>php -m</code> 查看已安装扩展。</li> <li>在终端中，您可以根据查询结果安装对应缺失的扩展。
<ul><li>如缺失<code>Exif</code>扩展。可以使用以下命令进行编译安装扩展 <code>Exif</code> 扩展。</li></ul></li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>以下路径仅提供示例。请根据实际情况进行输入。</p></div> <div class="language- extra-class"><pre class="language-text"><code># 使用 cd 命令进入 php 的源码的 exif 模块目录。
cd /root/lnmp1.7/src/php-7.3.23/ext/exif/

# 执行 phpize 脚本。
/usr/local/php/bin/phpize

# 编译配置。
./configure --with-php-config=/usr/local/php/bin/php-config

# 编译安装 exif 模块。
make &amp;&amp; make install
</code></pre></div><ol start="3"><li>配置 <code>php.ini</code> 文件。可在终端中输入 <code>php --ini</code> 查看 <code>php.ini</code> 配置文件路径。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/149f2f45d6c305fa8710fe265c6be57d.png" alt=""></p> <ol start="4"><li>您可通过 <code>vim</code> 命令，或使用 WinSCP 工具，根据查询到的文件路径，打开并编辑 <code>php.ini</code> 文件，去掉以下字段前面的 <code>;</code> 分号，并保存 <code>php.ini</code>  文件。如下所示</li></ol> <div class="language- extra-class"><pre class="language-text"><code>extension=exif    
exif.encode_unicode = ISO-8859-15
exif.decode_unicode_motorola = UCS-2BE
exif.decode_unicode_intel    = UCS-2LE
exif.encode_jis =
exif.decode_jis_motorola = JIS
exif.decode_jis_intel    = JIS=
</code></pre></div><ol start="5"><li>重启 PHP 与 Caddy 服务。<div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>您可以参考命令 <code>systemctl restart php-fpm</code> 与 <code>systemctl restart caddy</code> 重启 PHP 与 Caddy 服务。</p></div></li></ol> <h4 id="安装-php-函数"><a href="#安装-php-函数" class="header-anchor">#</a> 安装 PHP 函数</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Discuz! Q 依赖于 <code>symlink</code>、<code>readlink</code>、 <code>putenv</code>、 <code>realpath</code>、<code>shell_exec</code> 函数，在 PHP 中需开启以上函数。</li> <li>以下操作因为系统、软件版本的不同，操作上会有所差异，请根据您的具体情况进行开启对应函数，以下操作仅提供示例。</li></ul></div> <ol><li>打开并编辑 <code>php.ini</code> 文件。查找 <code>disable_functions</code> 字段，并删除禁用掉的 <code>symlink</code>、<code>readlink</code>、 <code>putenv</code>、 <code>realpath</code>、<code>shell_exec</code> 函数。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>disable_functions = passthru,exec,system,chroot,chgrp,chown,shell_exec,proc_open,proc_get_status,popen,ini_alter,ini_restore,dl,openlog,syslog,popepassthru,stream_socket_server
</code></pre></div><ol start="2"><li>保存 <code>php.ini</code>文件,并重启 PHP 与 Caddy 服务。</li></ol> <h4 id="步骤二-下载并解压-discuz-q-安装包"><a href="#步骤二-下载并解压-discuz-q-安装包" class="header-anchor">#</a> 步骤二：下载并解压 Discuz！Q 安装包</h4> <ol><li>您可以通过以下命令在网站主目录下创建 Discuz！Q 网站目录并下载 Discuz！Q 安装包与解压至网站目录。</li></ol> <div class="language- extra-class"><pre class="language-text"><code># 创建 Discuz！Q 网站目录，目录名可自定义，此处以 discuz 为例。
mkdir discuz

# 进入 discuz目录
cd discuz

#下载 Discuz！Q 安装包
wget -c https://discuzq.icu

# 解压 Discuz！Q 安装包
unzip dzq_latest_install.zip
</code></pre></div><h4 id="步骤三-配置-caddy"><a href="#步骤三-配置-caddy" class="header-anchor">#</a> 步骤三：配置 Caddy</h4> <ol><li>您可通过 <code>vim</code> 命令，或使用 WinSCP 工具，打开 <code>Caddyfile</code> 配置文件进行以下配置。</li></ol> <h4 id="root-配置-2"><a href="#root-配置-2" class="header-anchor">#</a> root 配置</h4> <ol><li>请将<code>root</code>目录指向 <code>&lt;站点主目录&gt;/public</code>目录，配置请参考如下：<div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>以下是示例，请按自己的实际配置设置。</p></div></li></ol> <div class="language- extra-class"><pre class="language-text"><code>root * /var/www/discuz/public
</code></pre></div><ol start="2"><li><p>保存 <code>Caddyfile</code>文件，重启 Caddy 服务。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果您使用的是  Ubuntu 系统，建议您将 <code>caddy.service</code>配置文件下的 <code>PrivateTmb</code>字段配置为<code>false</code>。否则可能导致访问 Discuz! Q 时 ，随机性产生 404 页面。</p></div></li></ol> <h4 id="步骤四-初始化安装-discuz-q-2"><a href="#步骤四-初始化安装-discuz-q-2" class="header-anchor">#</a> 步骤四：初始化安装 Discuz! Q</h4> <ol><li>打开本地浏览器，访问 <code>http://&lt;绑定网站的域名名称&gt;/install</code> 。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/d571ed3234565af42c508666b827ca37.png" alt=""></p> <ol start="2"><li><p>单击【下一步】，Discuz! Q 将自行进行站点检查，如有报错等问题。可参考 <a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html" target="_blank" rel="noopener noreferrer">常见问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行排查处理。</p></li> <li><p>Discuz! Q 检查完成后，需配置网站相关信息。如下图所示：</p></li></ol> <p><img src="https://main.qcloudimg.com/raw/8e3ac52669180620b946750787b50c95.png" alt=""></p> <ul><li><strong>站点名称</strong>：请输入您的站点名称信息，可自定义。</li> <li><strong>MySQL 服务器地址</strong>：请输入您的 MySQL 服务器地址。</li> <li><strong>数据库名称</strong>：请输入您的数据库名称。</li> <li><strong>MySQL 用户名</strong>：请输入您的数据库用户名。</li> <li><strong>MySQL 密码</strong>：请输入您的数据库密码。</li> <li><strong>表前缀</strong>：可选，可自定义数据库表前缀名称。默认不填。</li> <li><strong>设置管理员用户名</strong>：请输入您 Discuz! Q 站点的管理员用户名。</li> <li><strong>设置管理员密码</strong>：请输入您 Discuz! Q 站点的管理员密码。</li> <li><strong>管理员密码确认</strong>：请再次输入您 Discuz! Q 站点的管理员密码。</li></ul> <ol start="4"><li>单击【下一步】。即可完成 DIscuz！Q 的安装部署。</li></ol> <h4 id="步骤五-添加计划任务-2"><a href="#步骤五-添加计划任务-2" class="header-anchor">#</a> 步骤五：添加计划任务</h4> <p>为保证 DIscuz！Q 站点功能的正常使用。您还需要在服务器添加计划任务。在终端中输入以下命令并执行。</p> <div class="language- extra-class"><pre class="language-text"><code>php &lt;网站主目录&gt;/disco schedule:run &gt;&gt; /dev/null 2&gt;&amp;1
</code></pre></div><h2 id="基于宝塔"><a href="#基于宝塔" class="header-anchor">#</a> 基于宝塔</h2> <h4 id="操作场景-4"><a href="#操作场景-4" class="header-anchor">#</a> 操作场景</h4> <p>本文档将指导您如何在已安装宝塔面板的 Linux 服务器上安装部署 DIscuz！Q。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>本文档以宝塔面板 7.3.0 版本、CentOS 7.6 系统为例。</p></div> <h4 id="前提条件-4"><a href="#前提条件-4" class="header-anchor">#</a> 前提条件</h4> <ul><li>宝塔面板安装的 PHP 版本需为 7.2 及以上，MySQL 版本需要为 MySQL 5.7.9 及以上。</li> <li>已成功登录宝塔控制台。</li></ul> <h4 id="操作步骤-4"><a href="#操作步骤-4" class="header-anchor">#</a> 操作步骤</h4> <h4 id="步骤一-配置php-3"><a href="#步骤一-配置php-3" class="header-anchor">#</a> 步骤一：配置PHP</h4> <h4 id="安装扩展-4"><a href="#安装扩展-4" class="header-anchor">#</a> 安装扩展</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Discuz！Q 依赖于 <code>fileinfo</code> 和 <code>exif</code> 两个扩展运行，部署前需对 PHP 进行相关配置。以下操作将指导您安装<code>fileinfo</code> 和<code>exif</code> 扩展。</p></div> <ol><li>在宝塔控制台中，单击【软件商城】-&gt;【已安装】，查找已安装的 PHP 软件。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/63a722f7fd3a159978343331d14d9736.png" alt=""></p> <ol start="2"><li>单击选择需要为 Discuz！Q 使用的 PHP 软件名称（需为7.2及以上）。此处以 PHP-7.2 为例。</li></ol> <p><img src="https://main.qcloudimg.com/raw/b63aed08a014d1821f75281192561aad.png" alt=""></p> <ol start="3"><li>在弹出的 【php 管理】窗口中，单击【安装扩展】，进行安装扩展设置。如下图所示</li></ol> <p><img src="https://main.qcloudimg.com/raw/189db4e283e426bf9d704e647c3349e3.png" alt=""></p> <ol start="4"><li>选择【fileinfo】与【exif】，并单击【安装】。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/35c37af44765699060f45a2b3f672df5.png" alt=""></p> <ol start="5"><li>在弹出的 <code>fileinfo</code> 安装窗口中，单击【确定】。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/17fec169be7dbcec963425ccf6742406.png" alt=""></p> <ol start="6"><li>php 管理窗口中【fileinfo】与【exif】状态栏显示为<img src="https://main.qcloudimg.com/raw/6afdf7dacebf13ae1615976c36da021f.png" alt="">即为安装成功。</li></ol> <h4 id="删除禁用函数"><a href="#删除禁用函数" class="header-anchor">#</a> 删除禁用函数</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Discuz！Q 需删除禁用的函数 <code>putenv</code>、<code>readlink</code>、<code>symlink</code>、<code>shell_exec</code> ，部署前需对 PHP 进行相关配置。以下操作将指导您删除禁用函数 <code>putenv</code>、<code>readlink</code>、<code>symlink</code>、<code>shell_exec</code> 。</p></div> <ol><li>在 【php 管理】窗口中，单击【禁用函数】，进入禁用函数设置页面。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/0c31e34664a77eeb07cc3a517b19dae3.png" alt=""></p> <ol start="2"><li>在函数列表中单击【删除】函数 <code>putenv</code>、<code>readlink</code>、<code>symlink</code>、<code>shell_exec</code> ，即可删除禁用的函数。</li></ol> <h4 id="步骤二-创建站点"><a href="#步骤二-创建站点" class="header-anchor">#</a> 步骤二：创建站点</h4> <ol><li>在宝塔控制台中，单击【网站】-&gt;【添加站点】。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/59f1d176aa8cd67b6fc21bea433e802a.png" alt=""></p> <ol start="2"><li>在弹出的添加网站窗口中，输入相关配置信息。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/e447eebc5b027ee24615721c18085d0c.png" alt=""></p> <ul><li>域名：输入绑定 Discuz！Q 域名。<div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>确保绑定的域名已添加相关解析。如您的域名使用腾讯云 DNS 解析 DNSPod ，详情操作可参考：<a href="https://cloud.tencent.com/document/product/302/3446" target="_blank" rel="noopener noreferrer">快速添加域名解析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></div></li> <li>备注：可选，可添加网站的备注信息。</li> <li>根目录：网站文件根目录。一般情况使用默认 <code>/www/wwwroot</code> 路径。</li> <li>FTP：可选，可创建 FTP 服务。默认不创建。</li> <li>数据库：可选，您可在您的服务器内创建数据库进行使用。也可以其他数据库,数据库类型需为 MySQL 5.7.9 版本以上或 MariaDB 10.2 以上。如：<a href="https://cloud.tencent.com/product/cdb" target="_blank" rel="noopener noreferrer">云数据库 TencentDB for MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。详情操作请参考：<a href="https://cloud.tencent.com/document/product/236" target="_blank" rel="noopener noreferrer">云数据库 MySQL 产品文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如需在服务器内创建数据库进行使用，请选择【MySQL】,【utf8mb4】，并输入数据库用户名以及密码。</p></div> <ul><li>程序类型：PHP，默认不可选。</li> <li>PHP版本：请选择已配置完成的 PHP 版本。</li> <li>网站分类：默认分类。可根据实际情况进行选择。</li></ul> <p>3.单击【提交】。即可创建站点。</p> <h4 id="步骤三-远程下载-discuz-q-部署文件压缩包"><a href="#步骤三-远程下载-discuz-q-部署文件压缩包" class="header-anchor">#</a> 步骤三：远程下载 DIscuz！Q 部署文件压缩包</h4> <ol><li>单击已创建的 Discuz！Q 根目录路径，如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/ee84ac3e473b5a2662a9d6d5a72748aa.png" alt=""></p> <ol start="2"><li>在文件目录中，单击【远程下载】。在弹出的下载文件窗口中输入相关信息。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/6a2de56d62244bc1a6b86dc8c1e1084b.png" alt=""></p> <ul><li>URL地址：请输入 Discuz！Q 下载地址： <code>https://discuzq.icu</code>。</li> <li>下载到：默认不修改。</li> <li>文件名：默认不修改，输入下载路径后将自动进行填充。</li></ul> <ol start="3"><li>单击【确认】。系统将自行下载 DIscuz！Q 部署文件，请耐心等待。</li></ol> <h4 id="步骤四-解压-discuz-q-部署文件压缩包"><a href="#步骤四-解压-discuz-q-部署文件压缩包" class="header-anchor">#</a> 步骤四：解压  DIscuz！Q 部署文件压缩包</h4> <ol><li><p>选择已下载好 Discuz！Q 部署文件压缩包，并单击【解压】。如下图所示：
<img src="https://main.qcloudimg.com/raw/3c54e46dcc0e4b087d65f3c8b5ac6800.png" alt=""></p></li> <li><p>在弹出的解压文件窗口中，单击【解压】。如下图所示：</p></li></ol> <p><img src="https://main.qcloudimg.com/raw/27527d5113e8c2d6584e5bc2003402a7.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>文件解压成功后，可自行删除 Discuz！Q 部署文件压缩包，不影响 Discuz！Q 的正常使用。</p></div> <h4 id="步骤五-修改网站配置"><a href="#步骤五-修改网站配置" class="header-anchor">#</a> 步骤五：修改网站配置</h4> <ol><li>在宝塔控制台中，单击【网站】，并选择已创建 Discuz！Q  站点，单击【设置】。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/266a9747c34988e8c1c4c438b88793c9.png" alt=""></p> <ol start="2"><li>在弹出的站点修改窗口中，单击【网站目录】，进行网站目录相关设置。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/7da0693dcb1f6c27ce6f69ec2f50bbfb.png" alt=""></p> <ol start="3"><li>运行目录勾选 <code>/public</code>。如下图所示:</li></ol> <p><img src="https://main.qcloudimg.com/raw/30b5d8759e5d541e0c93170844bb3693.png" alt=""></p> <ol start="4"><li>单击【保存】。</li></ol> <h5 id="配置伪静态"><a href="#配置伪静态" class="header-anchor">#</a> 配置伪静态</h5> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果使用 <code>Apache</code>服务，此步操作无需配置；如果使用 <code>Nginx</code> 服务，请按照如下进行设置伪静态。</p></div> <ol><li>进入【网站】，单击刚才添加站点，操作栏处【设置】。</li> <li>弹出的【站点修改】窗口中，单击【伪静态】，将以下内容复制粘贴进去，并单击【保存】。</li></ol> <div class="language- extra-class"><pre class="language-text"><code>location / {
  try_files $uri $uri/ /index.php?$query_string;
}
</code></pre></div><h5 id="设置-gzip"><a href="#设置-gzip" class="header-anchor">#</a> 设置 gzip</h5> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果使用Apache服务，此步操作无需配置；如果使用 Nginx 服务，请按照如下进行设置 gzip。</p></div> <ol><li>单击【软件商城】，并查找到您安装的 Nginx。</li> <li>单击 Nginx 操作栏的【设置】。</li> <li>在弹出的【nginx 管理】窗口中，单击【配置修改】。</li> <li>在【配置修改】中查找到 <code>gzip_types</code> 字段并在前端添加 <code>application/json</code> 和末尾处添加 <code>application/vnd.api+json</code> 代码。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/74128e9f20252192ced5a0fc7a1e6ad4.png" alt=""></p> <ol start="5"><li>单击 【性能调整】，在 gzip 处选择【开启】。若已开启请忽略此步操作。</li> <li>单击【保存】。重启 Nginx 服务。</li></ol> <h4 id="步骤六-初始化安装-discuz-q"><a href="#步骤六-初始化安装-discuz-q" class="header-anchor">#</a> 步骤六：初始化安装 Discuz! Q</h4> <ol><li>打开本地浏览器，访问 <code>http://&lt;绑定网站的域名名称&gt;/install</code> 。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/d571ed3234565af42c508666b827ca37.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>站点如需部署 SSL 证书，使用 HTTPS 协议进行站点访问。请在以下操作之前部署安装 SSL 证书，并使用<code>https://&lt;绑定网站的域名名称&gt;/install</code>  进行访问。部署安装 SSL 证书详情操作请参考： <a href="https://cloud.tencent.com/document/product/400/50874" target="_blank" rel="noopener noreferrer">宝塔服务器证书安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>如需购买 SSL 证书，可参考 <a href="https://cloud.tencent.com/document/product/400/7995" target="_blank" rel="noopener noreferrer">SSL 证书购买流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，请根据您的实际情况进行购买相关证书。腾讯云为 Discuz! Q 站点提供免费 SSL 证书申请。详情请查看：<a href="https://cloud.tencent.com/document/product/400/6814" target="_blank" rel="noopener noreferrer">域名型（DV）免费证书申请流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <ol start="2"><li><p>单击【下一步】，Discuz! Q 将自行进行站点检查。如有报错等问题，请查看 <a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html" target="_blank" rel="noopener noreferrer">常见问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行排查处理。</p></li> <li><p>Discuz! Q 检查完成后，需配置网站相关信息。如下图所示：</p></li></ol> <p><img src="https://main.qcloudimg.com/raw/8e3ac52669180620b946750787b50c95.png" alt=""></p> <ul><li><strong>站点名称</strong>：请输入您的站点名称信息，可自定义。</li> <li><strong>MySQL 服务器地址</strong>：请输入您的 MySQL 服务器地址，如您使用宝塔创建的服务器本地数据库，请输入<code>127.0.0.1</code>即可。</li> <li><strong>数据库名称</strong>：请输入您的数据库名称。如您使用宝塔创建的服务器本地数据库，可登录服务器的宝塔控制台，【数据库】进行查看。</li> <li><strong>MySQL 用户名</strong>：请输入您的数据库用户名。如您使用宝塔创建的服务器本地数据库，可登录服务器的宝塔控制台，【数据库】进行查看。</li> <li><strong>MySQL 密码</strong>：请输入您的数据库密码。如您使用宝塔创建的服务器本地数据库，可登录服务器的宝塔控制台，【数据库】进行查看。</li> <li><strong>表前缀</strong>：可选，可自定义数据库表前缀名称。默认不填。</li> <li><strong>设置管理员用户名</strong>：请输入您 Discuz! Q 站点的管理员用户名。</li> <li><strong>设置管理员密码</strong>：请输入您 Discuz! Q 站点的管理员密码。</li> <li><strong>管理员密码确认</strong>：请再次输入您 Discuz! Q 站点的管理员密码。</li></ul> <ol start="4"><li>单击【下一步】。即可完成 DIscuz！Q 的安装部署。</li></ol> <h4 id="步骤七-添加计划任务"><a href="#步骤七-添加计划任务" class="header-anchor">#</a> 步骤七：添加计划任务</h4> <p>为保证 DIscuz！Q 站点功能的正常使用。您还需要在宝塔面板中添加计划任务。</p> <ol><li>登录宝塔控制台，单击【计划任务】，进入计划任务页面，并选择与填写相关信息。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/e7443e1378a3149d1de8108321b16e7e.png" alt=""></p> <ul><li>任务类型：选择 Shell 脚本。</li> <li>任务名称：可自定义，建议填写【Discuz！Q 计划任务】 便于区分。</li> <li>执行周期：选择【N分钟】，并填写【1】分钟。</li> <li>脚本内容：请输入以下命令，命令【网站主目录】请按实际情况做相应调整。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>sudo -u www /usr/bin/php /www/wwwroot/&lt;网站主目录&gt;/disco schedule:run
</code></pre></div><ol start="2"><li>单击【添加任务】。</li></ol> <h2 id="基于-docker-容器-推荐"><a href="#基于-docker-容器-推荐" class="header-anchor">#</a> 基于 Docker 容器 （推荐）</h2> <h4 id="操作场景-5"><a href="#操作场景-5" class="header-anchor">#</a> 操作场景</h4> <p>本文档将指导您如何在已安装 docker-ce 运行环境的 Linux 服务器上安装部署 Discuz! Q。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果您的服务器还未安装 docker-ce 运行环境，腾讯云提供了 <a href="https://mirrors.tencent.com/docker-ce/" target="_blank" rel="noopener noreferrer">docker 镜像<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，您可直接下载安装。</p></div> <h4 id="前提条件-5"><a href="#前提条件-5" class="header-anchor">#</a> 前提条件</h4> <p>已成功登录 Linux 服务器。</p> <h4 id="操作步骤-5"><a href="#操作步骤-5" class="header-anchor">#</a> 操作步骤</h4> <h4 id="步骤一-安装-discuz-q"><a href="#步骤一-安装-discuz-q" class="header-anchor">#</a> 步骤一：安装 Discuz! Q</h4> <ol><li>在终端中，请输入以下命令。docker 将会自动下载并运行最新版本的 Discuz! Q。如下所示：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>docker run -d -p 80:80 -p 443:443 ccr.ccs.tencentyun.com/discuzq/dzq:latest
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>容器基于 Ubuntu 18.04，其中已安装 Nginx 1.14, PHP 7.2, MySQL 5.7 和所有的相关依赖，并且已经完成 Web 服务器配置和计划任务配置。</li> <li>安装时警告 <code>WARNING: IPv4 forwarding is disabled. Networking will not work.</code>。可使用命令 <code>vim /etc/sysctl.conf</code> 编辑配置文件。修改 <code>net.ipv4.ip_forward</code>字段值为 <code>1</code> 开启转发并使用命令 <code>systemctl restart network</code> 重启网络服务。</li> <li>以上命令用于快速启动并测试 Discuz! Q，数据库和站点数据都将保存在容器内部，容器被删除将会造成数据丢失。</li> <li>如果您想基于容器长期运行Discuz! Q，建议将数据库和站点数据保存于容器外部，请参考<a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html#%E5%AE%B9%E5%99%A8%E7%9A%84%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener noreferrer">容器的更多配置说明进行配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul></div> <h4 id="步骤二-初始化安装-discuz-q"><a href="#步骤二-初始化安装-discuz-q" class="header-anchor">#</a> 步骤二：初始化安装 Discuz! Q</h4> <ol><li>打开本地浏览器，访问 <code>http://&lt;服务器外网 IP 地址&gt;/install</code> 并配置网站相关信息。如下图所示：</li></ol> <p><img src="https://s3.jpg.cm/2021/01/17/wE3Fu.png" alt=""></p> <ul><li><strong>站点名称</strong>：请输入您的站点名称信息，可自定义。</li> <li><strong>MySQL Host</strong>：请输入您的 MySQL 服务器地址，如您使用 docker 创建的本地数据库，请输入<code>127.0.0.1</code>即可。</li> <li><strong>MySQL 数据库</strong>：请输入您的数据库名称。如您使用 docker 创建的本地数据库，请输入<code>root</code>即可。</li> <li><strong>MySQL 用户名</strong>：请输入您的数据库用户名。如您使用 docker 创建的本地数据库，请输入<code>root</code>即可。</li> <li><strong>MySQL 密码</strong>：如您使用 docker 创建的本地数据库，请输入<code>root</code>即可。</li> <li><strong>表前缀</strong>：可选，可自定义数据库表前缀名称。默认不填。</li> <li><strong>管理员 用户名</strong>：请输入您 Discuz! Q 站点的管理员用户名。</li> <li><strong>管理员 密码</strong>：请输入您 Discuz! Q 站点的管理员密码。</li> <li><strong>管理员 确认密码</strong>：请再次输入您 Discuz! Q 站点的管理员密码。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>如果您想基于容器长期运行 Discuz! Q，建议将数据库和站点数据保存于容器外部，请参考 <a href="https://discuzq.icu/docs/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html#%E5%AE%B9%E5%99%A8%E7%9A%84%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener noreferrer">容器的更多配置说明进行配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul></div> <ol start="2"><li>单击【安装】。即可完成 DIscuz！Q 的安装部署。</li></ol> <h4 id="步骤三-系统管理与配置"><a href="#步骤三-系统管理与配置" class="header-anchor">#</a> 步骤三：系统管理与配置</h4> <p>安装完成后，您可以访问 <code>http://&lt;服务器外网 IP 地址&gt;/admin</code> 进入后台，输入在安装的时候设置的管理员账号和密码，进行管理与配置。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/安装/Windows 主机.html" class="prev">
        Windows 主机安装
      </a></span> <span class="next"><a href="/docs/使用/初次使用配置说明.html">
        初次使用配置说明
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.4a94bff3.js" defer></script><script src="/docs/assets/js/2.65b3c0ea.js" defer></script><script src="/docs/assets/js/1.93f47670.js" defer></script><script src="/docs/assets/js/40.a7c7edfd.js" defer></script>
  </body>
</html>
