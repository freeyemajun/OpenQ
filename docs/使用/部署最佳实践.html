<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Discuz! Q  最佳部署实践 | DiscuzQ 安装文档</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>
      document.addEventListener("DOMContentLoaded", function(){
        console.log("ready");
        var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && isChrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                var element_to_scroll_to = document.getElementById(decodeURI(hash.substr(1)));
                element_to_scroll_to.scrollIntoView();
            }, 300);
        }
      });
</script>
    <meta name="description" content="">
    
    <link rel="preload" href="/docs/assets/css/0.styles.1dac2540.css" as="style"><link rel="preload" href="/docs/assets/js/app.4a94bff3.js" as="script"><link rel="preload" href="/docs/assets/js/2.65b3c0ea.js" as="script"><link rel="preload" href="/docs/assets/js/1.93f47670.js" as="script"><link rel="preload" href="/docs/assets/js/29.3f95441b.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e303b1fe.js"><link rel="prefetch" href="/docs/assets/js/11.caa9adf9.js"><link rel="prefetch" href="/docs/assets/js/12.f47f63d5.js"><link rel="prefetch" href="/docs/assets/js/13.93dc81ea.js"><link rel="prefetch" href="/docs/assets/js/14.704d1a26.js"><link rel="prefetch" href="/docs/assets/js/15.2330e6dc.js"><link rel="prefetch" href="/docs/assets/js/16.6aaa40a5.js"><link rel="prefetch" href="/docs/assets/js/17.e32a5229.js"><link rel="prefetch" href="/docs/assets/js/18.1fa05986.js"><link rel="prefetch" href="/docs/assets/js/19.53f57844.js"><link rel="prefetch" href="/docs/assets/js/20.864577f6.js"><link rel="prefetch" href="/docs/assets/js/21.b4e831fa.js"><link rel="prefetch" href="/docs/assets/js/22.243f8c8f.js"><link rel="prefetch" href="/docs/assets/js/23.7addb889.js"><link rel="prefetch" href="/docs/assets/js/24.ef0496a7.js"><link rel="prefetch" href="/docs/assets/js/25.89b549f4.js"><link rel="prefetch" href="/docs/assets/js/26.0a614c82.js"><link rel="prefetch" href="/docs/assets/js/27.c737aa41.js"><link rel="prefetch" href="/docs/assets/js/28.1e6bd7b4.js"><link rel="prefetch" href="/docs/assets/js/3.640e72c3.js"><link rel="prefetch" href="/docs/assets/js/30.778c4be0.js"><link rel="prefetch" href="/docs/assets/js/31.7bb18d07.js"><link rel="prefetch" href="/docs/assets/js/32.ace851f7.js"><link rel="prefetch" href="/docs/assets/js/33.80a8af0e.js"><link rel="prefetch" href="/docs/assets/js/34.d85fff39.js"><link rel="prefetch" href="/docs/assets/js/35.3adf9801.js"><link rel="prefetch" href="/docs/assets/js/36.9a107e60.js"><link rel="prefetch" href="/docs/assets/js/37.6d5ed231.js"><link rel="prefetch" href="/docs/assets/js/38.d4773946.js"><link rel="prefetch" href="/docs/assets/js/39.1f25f111.js"><link rel="prefetch" href="/docs/assets/js/4.6fcba847.js"><link rel="prefetch" href="/docs/assets/js/40.a7c7edfd.js"><link rel="prefetch" href="/docs/assets/js/41.6c906a58.js"><link rel="prefetch" href="/docs/assets/js/42.19af8c9b.js"><link rel="prefetch" href="/docs/assets/js/43.c3501ba2.js"><link rel="prefetch" href="/docs/assets/js/44.095b6352.js"><link rel="prefetch" href="/docs/assets/js/45.f712c735.js"><link rel="prefetch" href="/docs/assets/js/46.ea4a5f90.js"><link rel="prefetch" href="/docs/assets/js/47.4c923c28.js"><link rel="prefetch" href="/docs/assets/js/48.a2893909.js"><link rel="prefetch" href="/docs/assets/js/49.4c0fc68d.js"><link rel="prefetch" href="/docs/assets/js/5.5755b19e.js"><link rel="prefetch" href="/docs/assets/js/50.a768c789.js"><link rel="prefetch" href="/docs/assets/js/51.9145a08d.js"><link rel="prefetch" href="/docs/assets/js/52.bea51864.js"><link rel="prefetch" href="/docs/assets/js/53.d24412c9.js"><link rel="prefetch" href="/docs/assets/js/54.cd9f37d4.js"><link rel="prefetch" href="/docs/assets/js/55.a856d50b.js"><link rel="prefetch" href="/docs/assets/js/56.b3072981.js"><link rel="prefetch" href="/docs/assets/js/57.e9c27eb6.js"><link rel="prefetch" href="/docs/assets/js/58.a94f49c6.js"><link rel="prefetch" href="/docs/assets/js/59.76707aea.js"><link rel="prefetch" href="/docs/assets/js/6.c1859e2f.js"><link rel="prefetch" href="/docs/assets/js/60.79251db4.js"><link rel="prefetch" href="/docs/assets/js/61.742230c8.js"><link rel="prefetch" href="/docs/assets/js/62.ca1bb933.js"><link rel="prefetch" href="/docs/assets/js/63.75830b2e.js"><link rel="prefetch" href="/docs/assets/js/64.243cb0d7.js"><link rel="prefetch" href="/docs/assets/js/7.d29ddd45.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.d97d6166.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.1dac2540.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">DiscuzQ 安装文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  返回
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://discuzq.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  返回
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安装</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>使用</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/使用/初次使用配置说明.html" class="sidebar-link">初次使用配置说明</a></li><li><a href="/docs/使用/部署最佳实践.html" class="active sidebar-link">Discuz! Q  最佳部署实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#痛点说明" class="sidebar-link">痛点说明</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#评估系统容量" class="sidebar-link">评估系统容量</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#使用开源应用中心一键部署-推荐" class="sidebar-link">使用开源应用中心一键部署（推荐）</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#私有化部署-cvm" class="sidebar-link">私有化部署（CVM）</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#完成基础环境部署" class="sidebar-link">完成基础环境部署</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#安全配置" class="sidebar-link">安全配置</a></li><li class="sidebar-sub-header"><a href="/docs/使用/部署最佳实践.html#性能优化" class="sidebar-link">性能优化</a></li></ul></li><li><a href="/docs/使用/购买资源包.html" class="sidebar-link">购买资源包</a></li><li><a href="/docs/使用/部署和配置最佳实践.html" class="sidebar-link">部署和配置最佳实践</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>升级和转换</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="discuz-q-最佳部署实践"><a href="#discuz-q-最佳部署实践" class="header-anchor">#</a> Discuz! Q  最佳部署实践</h1> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>本文档将帮助中小 Discuz! Q 站长最大程度低成本、高安全、可靠地使用 Discuz! Q。</p> <h2 id="痛点说明"><a href="#痛点说明" class="header-anchor">#</a> 痛点说明</h2> <ul><li>个人无技术背景或中小企业无相关技术人员支持，在选购云服务时无法根据用户量和实际情况进行选择。</li> <li>对 Discuz! Q 各项云服务功能和使用场景不了解。</li> <li>对各项安全设置不能进行系统评估。</li> <li>对 Discuz! Q 使用的架构不熟悉，导致无法对 Discuz! Q 进行性能调优提高用户体验和降低成本。</li></ul> <h2 id="评估系统容量"><a href="#评估系统容量" class="header-anchor">#</a> 评估系统容量</h2> <p>容量规划在互联网发展初期是一个非常重要的工作，主要的原因在于用户量较低时，过高配置将提高成本支出。当用户量激增时，服务器容量较小或扩容较为困难，您需要重新购买一台物理服务器，从部署到正式上线，其中需要的时间可能长达数周，期间影响用户体验，容易导致用户流失。
随着云计算行业的发展，服务器已经像水电等基础设施一样，可以按需付费、灵活部署、释放资源。这可使容量规划的重要性大大降低，在上线初期您可根据参考值进行选择，不用担心后续升降配置带来的风险，灵活扩展的同时，也可显著的降低成本。</p> <p>本文提供了两种云服务部署 Discuz! Q 方案，您可根据实际情况和需求进行选择：</p> <h2 id="使用开源应用中心一键部署-推荐"><a href="#使用开源应用中心一键部署-推荐" class="header-anchor">#</a> 使用开源应用中心一键部署（推荐）</h2> <p>腾讯云 <a href="https://app.cloud.tencent.com/" target="_blank" rel="noopener noreferrer">开源应用中心<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 正式部署 Discuz! Q  实现了高可靠、高性能、低成本的解决方案，推荐站长们使用。</p> <p><a href="https://app.cloud.tencent.com/"><img src="https://main.qcloudimg.com/raw/9c9887d61990b24d24ecfba87fa10852.png"></a></p> <p>开源应用中心正式开通 Discuz! Q 应用实例依托于云开发 CloudBase 以及相关云资源进行部署，部署过程中将会在当前账号下拉取或创建相关云资源。如下：</p> <h4 id="云托管"><a href="#云托管" class="header-anchor">#</a> 云托管</h4> <p>其原理在于弹性扩缩容：</p> <ul><li>无用户访问时，自动进入停机不收费模式，仅收取存储费用。大部分用户 Discuz! Q 站点，静态存储到文件存储 CFS 一年的费用约为是5元。</li> <li>少量用户访问，使用最小核心数。例如，Discuz! Q 站点只有5人同时在线，使用0.25核、0.2GiB内存、0.2GB流量、低成本模式运行、计算成本约为0.04元/小时。</li> <li>集群化部署。大并发访问时，自动扩容，满足用户流量的激增，不降低用户体验。小流量时自动缩容，使用更便捷，成本更低。</li></ul> <h4 id="示例"><a href="#示例" class="header-anchor">#</a> 示例：</h4> <p>对于大部分中小型站点，以一个小型 Discuz! Q 站点为例：</p> <ul><li>凌晨0点 - 9点，无用户访问，自动缩容到0，无任何费用。</li> <li>10点 - 20点，大部分人上班，论坛小核心低速使用，相当于使用了2.5核*10个小时。</li> <li>20点 - 24点，高峰期，扩容到2核4GiB内存使用，相当于8核*4小时。</li></ul> <p>云托管详细价格说明参见：<a href="https://cloud.tencent.com/document/product/1243/47823" target="_blank" rel="noopener noreferrer">产品定价<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="云原生数据库-tdsql-c-cynosdb"><a href="#云原生数据库-tdsql-c-cynosdb" class="header-anchor">#</a> 云原生数据库 TDSQL-C（cynosdb）</h4> <p>同样，腾讯云开源应用中心使用的云原生数据库 TDSQL-C（cynosdb）也是弹性自动扩容，数据库的消耗如下：</p> <ul><li>无用户访问时，自动进入停机不收费模式，仅收取存储费用，大部分用户站点，存储费用可以忽略。</li> <li>少量用户访问，使用最小核心数，例如，站点只有5人同时在线，使用0.25核，0.5GiB内存。</li> <li>集群化部署。大并发访问时，自动扩容，满足用户流量的激增，不降低用户体验。小流量时自动缩容，用户使用更便捷、成本更低。</li></ul> <h4 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例：</h4> <p>对于大部分中小型站点，以一个小型 Discuz! Q 站点为例：</p> <ul><li>凌晨 0点 - 9点，无用户访问，自动缩容到0，无任何费用。</li> <li>10点 - 20点，大部分人上班，论坛小核心低速使用，对应的资源是2.5CCU量。</li> <li>20点 - 24点，论坛扩容到1核2GiB内存使用，对应的资源是4CCU量。</li></ul> <p>一天的总体成本约为6.5CCU量，按照优惠价7元/45CCU计算，则一个月成本是30.3元，使用30.3元成本即可达到（1C2GiB）的云数据库体验。</p> <p>云原生数据库 TDSQL-C 详细价格说明参见：<a href="https://cloud.tencent.com/document/product/1003/30493" target="_blank" rel="noopener noreferrer">计费概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="文件存储-cloud-file-storage-cfs"><a href="#文件存储-cloud-file-storage-cfs" class="header-anchor">#</a> 文件存储（Cloud File Storage，CFS）</h4> <p>文件存储（Cloud File Storage，CFS）提供了可扩展的共享文件存储服务，可与腾讯云的 CVM 、容器、批量计算等服务搭配使用。CFS 提供了标准的 NFS 及 CIFS/SMB 文件系统访问协议，为多个 CVM 实例或其他计算服务提供共享的数据源，支持弹性容量和性能的扩展，现有应用无需修改即可挂载使用，是一种高可用、高可靠的分布式文件系统。</p> <h4 id="示例-3"><a href="#示例-3" class="header-anchor">#</a> 示例：</h4> <p>以一个中小型 Discuz! Q 站点为例。如果经常发布一些包含有图片、背景音乐、视频的文章，同时还有软件下载区等。</p> <p>如：使用中国大陆文件存储标准存储按量计费模式，每月预计占用标准存储容量100GiB。</p> <p>则每约预估存储空间费用：0.35元/GiB/月 × 100GiB  = 35元</p> <p>文件存储详细价格说明参见：<a href="https://cloud.tencent.com/document/product/582/47378" target="_blank" rel="noopener noreferrer">计费概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="对象存储-cloud-object-storage-cos"><a href="#对象存储-cloud-object-storage-cos" class="header-anchor">#</a> 对象存储（Cloud Object Storage，COS）</h4> <p>对象存储（Cloud Object Storage，COS）是腾讯云提供的一种存储海量文件的分布式存储服务，具有高扩展性、低成本、可靠安全等优点。您可简单、快速地接入 COS，进行多格式文件的上传、下载和管理，实现海量数据存储和管理。</p> <h4 id="示例-4"><a href="#示例-4" class="header-anchor">#</a> 示例：</h4> <p>对于大部分中小型站点，以一个中小型 Discuz! Q 站点为例。如果经常发布一些包含有图片、背景音乐、视频的文章，同时还有软件下载区等。并将网站内容存储在<strong>广州地域</strong>的<strong>标准存储</strong>服务中。</p> <p>如：每月预计占用标准存储容量50G，和写请求总计100万次。</p> <p>则在不享有的免费额度情况下，每月的费用分析如下：</p> <table><thead><tr><th style="text-align:left;">费用组成</th> <th style="text-align:left;">免费额度</th> <th style="text-align:left;">单价</th> <th style="text-align:left;">计费量</th> <th style="text-align:left;">费用（单价 * 计费量）</th></tr></thead> <tbody><tr><td style="text-align:left;">存储容量费用</td> <td style="text-align:left;">0</td> <td style="text-align:left;">0.118元/GB/月</td> <td style="text-align:left;">50GB</td> <td style="text-align:left;">5.9元</td></tr> <tr><td style="text-align:left;">请求费用</td> <td style="text-align:left;">0</td> <td style="text-align:left;">0.01元/万次</td> <td style="text-align:left;">100万次</td> <td style="text-align:left;">1元</td></tr> <tr><td style="text-align:left;">月费用</td> <td style="text-align:left;">-</td> <td style="text-align:left;">-</td> <td style="text-align:left;">-</td> <td style="text-align:left;"><strong>6.9元</strong></td></tr></tbody></table> <p>对象存储详细价格说明参见：<a href="https://cloud.tencent.com/document/product/582/47378" target="_blank" rel="noopener noreferrer">计费概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>因此，使用开源应用中心部署方案，整体成本可以下降80%而对用户的体验影响较小。</p> <h4 id="云点播-video-on-demand-vod"><a href="#云点播-video-on-demand-vod" class="header-anchor">#</a> 云点播（Video on Demand，VOD）</h4> <p>云点播（Video on Demand，VOD）是腾讯云提供的一种云端一体化的音视频点播服务平台，可以提供低延迟、高画质、高码率、多终端和视频安全等多种业务场景。您可以便捷的接入云点播服务平台，对音视频内容进行管理、处理和分发播放。</p> <h4 id="示例-5"><a href="#示例-5" class="header-anchor">#</a> 示例：</h4> <p>对于大部分 Discuz！Q 站点，无论是付费站点或者免费站点，音视频能力都是站点中不可缺少的一部分，音视频文件的存储和播放都是业务亟待解决的问题。</p> <p>以一个小型 Discuz! Q 站点为例：</p> <table><thead><tr><th><br>费用组成</th> <th><br>单价</th> <th><br>计费量</th> <th><br>费用（单价*计费量）</th> <th><br>降冷后费用</th></tr></thead> <tbody><tr><td><br>存储容量费用</td> <td><br>0.0048元/GB/日</td> <td><br>50GB</td> <td><br>7.2元</td> <td><br>3.6元</td></tr> <tr><td><br>转码费用</td> <td><br>0.016元/分钟</td> <td><br>5小时</td> <td><br>4.8元</td> <td><br>4.8元</td></tr> <tr><td><br>播放费用</td> <td><br>0.24元/GB</td> <td><br>25GB</td> <td><br>6元</td> <td><br>6元</td></tr> <tr><td><br>月费用</td> <td><br>-</td> <td><br>-</td> <td><br>18元</td> <td><br>14.4</td></tr></tbody></table> <p>合理购买和使用<strong>资源包</strong>和点播的<strong>智能降冷</strong>特性价格能<strong>有效帮助用户降低50%的成本</strong>，详细请参考云点播<a href="https://cloud.tencent.com/document/product/266/2838" target="_blank" rel="noopener noreferrer">计费概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和 如何将点播的媒体文件进行<a href="https://cloud.tencent.com/document/product/266/56196#.E5.AD.98.E5.82.A8.E7.B1.BB.E5.9E.8B.3Ca-id.3D.22type.22.3E.3C.2Fa.3E" target="_blank" rel="noopener noreferrer">智能降冷<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <h3 id="购买资源"><a href="#购买资源" class="header-anchor">#</a> 购买资源</h3> <p>根据以上资源说明，对于中小型 Discuz! Q 站点推荐以下购买方案：</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li><p>该购买方案需使用对象存储能力，需在 Discuz! Q 站点管理后台开启对象存储功能。详情操作参见：<a href="https://discuz.com/manual-admin/2.html#_2-7-6-%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8" target="_blank" rel="noopener noreferrer">开启对象存储<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>若您需使用云点播能力 ，需在 Discuz! Q 站点管理后台开启云点播功能。详情操作参见：<a href="https://discuz.com/docs/%E4%BA%91%E7%82%B9%E6%92%AD%E8%AE%BE%E7%BD%AE.html" target="_blank" rel="noopener noreferrer">开启云点播<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li></ul></div> <h4 id="云托管资源包"><a href="#云托管资源包" class="header-anchor">#</a> 云托管资源包</h4> <p>因使用对象存储能力，可有效降低云托管流量需求，推荐购买<strong>720核*小时、流量：30 GB</strong> 低流量云托管资源包 ，对比按量付费成本更低。该云托管资源包可以使用约2.3个月，每月45元成本即可达到（2C 4G 5Mbps）的云服务器 CVM 体验。购买资源包详细操作参见：<a href="https://discuz.com/docs/%E8%B4%AD%E4%B9%B0%E8%B5%84%E6%BA%90%E5%8C%85.html#%E6%A6%82%E8%BF%B0" target="_blank" rel="noopener noreferrer">资源包购买<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="云原生数据库-tdsql-c"><a href="#云原生数据库-tdsql-c" class="header-anchor">#</a> 云原生数据库 TDSQL-C</h4> <p>云原生数据库 TDSQL-C，无资源包，使用按量计费模式。</p> <h4 id="云点播资源包"><a href="#云点播资源包" class="header-anchor">#</a> 云点播资源包</h4> <p>推荐购买云点播资源包如下，可满足中小型 Discuz！Q 大部分情况下基本资源需求：</p> <ul><li>云点播体验包（新用户推荐）：含 10GB 流量 + 20GB存储 + 100分钟普通砖吗 + 30分钟极速高清转码 + 100分钟视频审核时长。</li> <li>云点播流量包100GB。</li> <li>云点播存储包50GB。</li> <li>云点播转码包5小时。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>登录并访问 <a href="https://cloud.tencent.com/act/event/discuzq" target="_blank" rel="noopener noreferrer">Discuz! Q 活动页<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，在购福利处，购买您需要的点播资源包。更多资源包请关注<a href="https://discuz.com/docs/%E8%B4%AD%E4%B9%B0%E8%B5%84%E6%BA%90%E5%8C%85.html#%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97" target="_blank" rel="noopener noreferrer">点播资源包购买<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p></div> <h4 id="对象存储资源包"><a href="#对象存储资源包" class="header-anchor">#</a> 对象存储资源包</h4> <p>推荐购买对象存储资源包组合如下，可满足中小型 Discuz! Q 大部分情况下基本资源需求：</p> <ul><li><p>存储容量：标准存储容量包 50GB。</p></li> <li><p>流量：外网下行流量包 50G。</p></li> <li><p>读写请求：标准存储请求包 100万次。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>购买资源包详细操作参见：<a href="https://discuz.com/docs/%E8%B4%AD%E4%B9%B0%E8%B5%84%E6%BA%90%E5%8C%85.html#%E6%A6%82%E8%BF%B0" target="_blank" rel="noopener noreferrer">资源包购买<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，或通过 Discuz! Q <a href="https://cloud.tencent.com/act/event/discuzq" target="_blank" rel="noopener noreferrer">官网活动页<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>直接购买，价格更低，更实惠。</p></div> <h4 id="文件存储-cloud-file-storage-cfs-2"><a href="#文件存储-cloud-file-storage-cfs-2" class="header-anchor">#</a> 文件存储（Cloud File Storage，CFS）</h4> <p>以上对象存储资源包中已包含存储容量，文件存储需求降低，推荐使用按量计费模式使用资源。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>使用开源应用中心一键部署 Discuz! Q 详细操作参见：<a href="https://discuz.com/docs/%E5%BC%80%E6%BA%90%E5%BA%94%E7%94%A8%E4%B8%AD%E5%BF%83%E5%AE%89%E8%A3%85.html" target="_blank" rel="noopener noreferrer">开源应用中心安装 Discuz! Q<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p></div> <h2 id="私有化部署-cvm"><a href="#私有化部署-cvm" class="header-anchor">#</a> 私有化部署（CVM）</h2> <p>如果您使用自己购买包年包月的云服务器 CVM 搭建 Discuz! Q 服务，您可参考以下数据来选择合适的服务器配置，更大的站点推荐使用集群配置方案。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>受限于数据时效性差异，该数据仅供参考。</p></div> <table><thead><tr><th>最大在线用户数量</th> <th>帖子规模（含回复）</th> <th>同时发帖回复</th> <th>推荐配置</th> <th>云数据库配置</th></tr></thead> <tbody><tr><td>50人</td> <td>500 - 5000</td> <td>5个</td> <td>1c2g</td> <td>使用本地数据库</td></tr> <tr><td>1000人</td> <td>20000 - 200000</td> <td>100个</td> <td>4c8g</td> <td>2c4g</td></tr></tbody></table> <h3 id="采购设备-完成基本配置"><a href="#采购设备-完成基本配置" class="header-anchor">#</a> 采购设备，完成基本配置</h3> <p>个人无技术背景的站长或无技术支持的企业，推荐您使用 <a href="https://discuz.com/docs/%E5%BC%80%E6%BA%90%E5%BA%94%E7%94%A8%E4%B8%AD%E5%BF%83%E5%AE%89%E8%A3%85.html" target="_blank" rel="noopener noreferrer">开源应用中心<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的 Discuz! Q  一键开通方式，该方案无需站长进行复杂配置，并且性能最优，成本最低。</p> <p>由于 Discuz! Q 开发和测试时，使用的服务器均为腾讯云。腾讯云对应的服务器和操作系统能够很好的支持 Discuz! Q。</p> <p>如果您需以云服务器 CVM 方式搭建，推荐您使用腾讯云云服务器 CVM。操作系统版本推荐使用 CentOS 7.6 或 CentOS 8.0，PHP 环境推荐 7.2、7.3、7.4 版本。购买云服务器可参考 <a href="https://cloud.tencent.com/product/cvm" target="_blank" rel="noopener noreferrer">腾讯云云服务器 CVM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="购买-cvm-与操作系统选型"><a href="#购买-cvm-与操作系统选型" class="header-anchor">#</a> 购买 CVM 与操作系统选型</h3> <ul><li>CVM 选型时，建议优先选择用户主要分布的地域，例如，您的 Discuz! Q  站点的主要用户群体在北京，建议选择北京地域的 CVM，可提高网络性能，降低延迟。</li> <li>CVM 对应的操作系统，推荐使用 CentOS 7.6 和 CentOS 8，Discuz! Q  开发人员主要使用这两种环境来做自验证，验证的较多，稳定、可靠性更高。</li> <li>如果您使用腾讯云云服务器 CVM ，可以直接选择腾讯云市场免费提供的 Discuz! Q  镜像，一键安装，完成所有的配置优化工作。
具体可参见 <a href="https://discuz.com/docs/%E8%85%BE%E8%AE%AF%E4%BA%91%E5%AE%89%E8%A3%85.html#%E9%95%9C%E5%83%8F-%E6%8E%A8%E8%8D%90" target="_blank" rel="noopener noreferrer">腾讯云镜像安装部署 Discuz! Q<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul> <h3 id="购买数据盘"><a href="#购买数据盘" class="header-anchor">#</a> 购买数据盘</h3> <h4 id="使用-ssd-有什么好处"><a href="#使用-ssd-有什么好处" class="header-anchor">#</a> 使用 SSD 有什么好处？</h4> <p>Discuz! Q 目前通过对帖子数据进行缓存，以降低数据库资源占用，改善访问性能。目前支持的缓存介质是磁盘，使用 SSD，相比普通的磁盘性能提升接近一倍 IO 吞吐量。具体可参见 <a href="https://cloud.tencent.com/document/product/362/2353" target="_blank" rel="noopener noreferrer">云硬盘类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <ul><li>如果预算充足，推荐购买腾讯云 SSD 硬盘，将 Discuz! Q 安装在 SSD 磁盘分区，预可以较大提升接口性能。</li> <li>如果预算一般，可以购买独立的高性能磁盘，DiscuzQ 和操作系统盘分离、更可靠、稳定。</li></ul> <h3 id="购买云数据库-使用内网访问"><a href="#购买云数据库-使用内网访问" class="header-anchor">#</a> 购买云数据库，使用内网访问</h3> <h4 id="为什么需要使用云数据库"><a href="#为什么需要使用云数据库" class="header-anchor">#</a> 为什么需要使用云数据库？</h4> <p>数据库本地安装，很容易和 Discuz! Q 的 PHP 程序争抢本地资源（CPU/内存/磁盘），导致性能劣化。未经过调优的 MySQL，会导致云服务器 CVM 资源紧张，降低程序性能，导致 1+1 &lt; 2 现象。</p> <ul><li>预算充足，用户数量较多，推荐使用分布式数据库 TDSQL。多数据分区分表，支持上千亿条数据和高并发访问。</li> <li>普通站点，推荐使用云数据库。</li> <li>低配站点，可以使用数据库本地部署，本地部署使用 <code>127.0.0.1</code> 或 <code>localhost</code> 环回访问可以获得最大的访问性能。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>数据库与腾讯云 CVM 建议部署在一个VPC 中，将可达到最大化性能表现。</p></div> <p><img src="https://main.qcloudimg.com/raw/e41d7492581686fd58a6efba08ec7d6f.png" alt=""></p> <h3 id="购买对象存储-cos-存储桶"><a href="#购买对象存储-cos-存储桶" class="header-anchor">#</a> 购买对象存储 COS 存储桶</h3> <h4 id="为什么要使用对象存储-cos-存储桶"><a href="#为什么要使用对象存储-cos-存储桶" class="header-anchor">#</a> 为什么要使用对象存储 COS 存储桶?</h4> <ul><li>性能更好。用户浏览 Discuz! Q  站点时，如果使用了对象存储 COS，内容资源的获取使用的是对象存储 COS 的带宽，性能更好更稳定，将云服务器 CVM 的带宽用来获取 API 数据，10Mbps 可以提供日活2万用户的 Discuz! Q 站点使用。
<img src="https://main.qcloudimg.com/raw/b3d3adc3a21b25699a6310a497c5e2ac.png" alt=""></li> <li>成本更低。同样的数据量，对象存储 COS 的成本只有云硬盘 CBS 的1/3。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>腾讯云对象存储 COS 针对个人用户赠送免费额度50GB的标准存储容量，企业用户 1TB 标准存储容量。具体可参见 <a href="https://cloud.tencent.com/document/product/436/6240" target="_blank" rel="noopener noreferrer">对象存储 COS 免费额度<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></div> <h2 id="完成基础环境部署"><a href="#完成基础环境部署" class="header-anchor">#</a> 完成基础环境部署</h2> <p>环境部署您可以参见以下方式进行部署：</p> <ul><li><a href="https://discuz.com/docs/%E5%BC%80%E6%BA%90%E5%BA%94%E7%94%A8%E4%B8%AD%E5%BF%83%E5%AE%89%E8%A3%85.html" target="_blank" rel="noopener noreferrer">开源应用中心安装（推荐）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>购买 CVM 部署安装：
<ul><li><a href="https://discuz.com/docs/Linux%20%E4%B8%BB%E6%9C%BA.html" target="_blank" rel="noopener noreferrer">Linux 主机安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://discuz.com/docs/Windows%20%E4%B8%BB%E6%9C%BA.html" target="_blank" rel="noopener noreferrer">Windows 主机安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h2 id="安全配置"><a href="#安全配置" class="header-anchor">#</a> 安全配置</h2> <h3 id="密码配置策略"><a href="#密码配置策略" class="header-anchor">#</a> 密码配置策略</h3> <p>配置密码字符类型提高密码难度。进入 DiscuzQ 站点后台 -&gt;【全局】-&gt;【注册与登录设置】-&gt;【密码字符类型】中建议勾选所有密码类型。如下图所示：</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>密码最小长度设置为6或者更多，密码字符类型应该至少勾选：数字、小写字母和符号三种。</p></div> <p><img src="https://main.qcloudimg.com/raw/87be1e7fdab82a868623da11c5832e25.png" alt=""></p> <h3 id="web-应用防火墙-waf"><a href="#web-应用防火墙-waf" class="header-anchor">#</a> Web 应用防火墙 (WAF)</h3> <h4 id="为什么使用-web-应用防火墙-waf"><a href="#为什么使用-web-应用防火墙-waf" class="header-anchor">#</a> 为什么使用 Web 应用防火墙（WAF）？</h4> <p>Web 应用防火墙（WAF）可以通过清洗流量，来显著提升站点的安全性，具体可参见 <a href="https://cloud.tencent.com/document/product/627/17470" target="_blank" rel="noopener noreferrer">Web 应用防火墙（WAF）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="短信验证码"><a href="#短信验证码" class="header-anchor">#</a> 短信验证码</h3> <p>通过配置短信验证码，可以避免用户恶意注册和恶意发帖，具体可参见 <a href="https://cloud.tencent.com/document/product/382" target="_blank" rel="noopener noreferrer">短信产品文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="安全合规配置"><a href="#安全合规配置" class="header-anchor">#</a> 安全合规配置</h3> <h4 id="为什么使用腾讯文本内容安全"><a href="#为什么使用腾讯文本内容安全" class="header-anchor">#</a> 为什么使用腾讯文本内容安全？</h4> <p>中国境内服务器如果不进行相应的内容审核，会导致站点或域名被封禁，以及站点不可正常使用。使用腾讯云的敏感词功能，可以降低站长的审核负担，提升用户发帖体验，Discuz! Q  目前支持三种文本内容安全的检查方式，包含：</p> <ul><li>本地敏感词检测（免费，依赖用户手工录入的敏感词）。</li> <li>小程序敏感词检测（免费）。</li> <li>腾讯云敏感词检测（付费）。</li></ul> <p>默认的检查逻辑如下：</p> <ol><li>先检查本地敏感词，检查是否触发，需要在管理后台导入敏感词。您可以使用该词库进行导入 <a href="https://discuz.chat/thread/15140" target="_blank" rel="noopener noreferrer">敏感词<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>如果您开启腾讯云敏感词检测，则使用腾讯云敏感词检测功能检查内容，需要在 <a href="https://console.cloud.tencent.com/cms/text/package" target="_blank" rel="noopener noreferrer">腾讯云控制台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 打开文本内容安全功能，并在 Discuz! Q 后台进行配置。</li> <li>如果没有开启腾讯云检测，并且站点有小程序功能，则使用小程序敏感词检测。</li></ol> <h4 id="为什么使用腾讯云图片内容安全"><a href="#为什么使用腾讯云图片内容安全" class="header-anchor">#</a> 为什么使用腾讯云图片内容安全？</h4> <p>主要用于审核图片，该业务使用和文本内容安全类似，也需要先在腾讯云控制台开启图片内容安全服务，而后在 Discuz! Q 后台开启。</p> <ul><li>购买内容安全套餐包，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/9e864f53c274363759c77f0e5a3c2f5c.png" alt=""></p> <ul><li>Discuz! Q  后台配置，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/054621c850ca59290f5cf0de78c81192.png" alt=""></p> <h3 id="安全配置【红包与悬赏】"><a href="#安全配置【红包与悬赏】" class="header-anchor">#</a> 安全配置【红包与悬赏】</h3> <p>验证回复开启手机号验证机制，防止恶意刷评论或抢红包。</p> <ol><li>登录 Discuz! Q 站点后台。依次单击【用户】-&gt;【用户角色】，在需要设置的用户角色处，单击【设置】。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/0eceb8ad1cb4e5152f7fee01ee1a5df1.png" alt=""></p> <ol start="2"><li>在用户角色页，单击【安全设置】页签，即可配置。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/76f430609aaf36cdb5de76fc4953dd80.png" alt=""></p> <h3 id="ddos-接入【推荐大型站点】"><a href="#ddos-接入【推荐大型站点】" class="header-anchor">#</a> DDOS 接入【推荐大型站点】</h3> <p>接入腾讯云 DDOS ，拒绝 DDOS 服务式攻击访问。具体可参见 <a href="https://cloud.tencent.com/document/product/1021/43890" target="_blank" rel="noopener noreferrer">DDOS 产品文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>若您使用开源应用中心部署方式，无需进行以下配置。</p></div> <h3 id="主机安全云云镜"><a href="#主机安全云云镜" class="header-anchor">#</a> 主机安全云云镜</h3> <p>开启腾讯云云服务器 CVM 的云镜功能，云镜会自动扫描服务器，检查是否存在 webshell 木马。
在服务器终端中，输入以下命令进行安装。</p> <div class="language- extra-class"><pre class="language-text"><code>wget http://u.yd.tencentyun.com/ydeyes_linux64.tar.gz -O ydeyes_linux64.tar.gz &amp;&amp; tar -zxvf ydeyes_linux64.tar.gz &amp;&amp; ./self_cloud_install_linux64.sh
</code></pre></div><p>执行命令：<code>ps -ef | grep YD</code> 即可查看 YDService与 YDLive 进程是否在运行中，如果有在运行中则安装成功。</p> <h3 id="运维部署权限控制"><a href="#运维部署权限控制" class="header-anchor">#</a> 运维部署权限控制</h3> <p>使用低权限用户运行 <code>nginx/php</code>，防止越权访问。例如 <code>www</code> 等。</p> <h3 id="管理端白名单-ip-访问"><a href="#管理端白名单-ip-访问" class="header-anchor">#</a> 管理端白名单 IP 访问</h3> <p>通过在 Nginx 中配置 IP 白名单，禁止未授权用户访问：</p> <ol><li>在 Nginx 的 <code>conf</code> 配置目录中，新增文件：<code>dzq_ip.conf</code> 文件，内容（示例）如下：</li></ol> <div class="language- extra-class"><pre class="language-text"><code># 每一行一个 ip
allow 191.11.22.33;
</code></pre></div><ol start="2"><li>Nginx 配置文件 <code>nginx.conf</code> 中，新增如下内容：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>location /static-admin/ {
    # 此处改为上一步中添加的 dzq_ip.conf 文件的实际路径
    include /usr/service/nginx/conf/dzq_ip.conf;
    deny all;
    try_files $uri $uri/ /index.php?$query_string;
}
location /admin/ {
    # 此处改为上一步中添加的 dzq_ip.conf 文件的实际路径
    include /usr/service/nginx/conf/dzq_ip.conf;
    deny all;
    try_files $uri $uri/ /index.php?$query_string;
}
</code></pre></div><ol start="3"><li>重新加载 Nginx 配置或重启 Nginx。</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>您可以使用 <code>nginx -t</code> 检测配置文件是否有错误，无错误后可执行 <code>nginx -s reload</code> 重新加载 Nginx 配置。</p></div> <h2 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h2> <h4 id="cos-存储桶开启-cdn"><a href="#cos-存储桶开启-cdn" class="header-anchor">#</a> COS 存储桶开启 CDN</h4> <p>COS 存储中开启 CDN 加速域名，可以让 COS 的访问直接通过 CDN 进行，加速 COS 资源访问速度。如下图所示:</p> <ul><li>腾讯云 COS 对象存储配置，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/12799442a2aa69444a94810e75cda9b2.png" alt=""></p> <ul><li>DiscuzQ 后台配置，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/f7725dccfe08e63050a0426959527597.png" alt=""></p> <h4 id="cdn-部署"><a href="#cdn-部署" class="header-anchor">#</a> CDN 部署</h4> <ol><li>登录 <a href="https://console.cloud.tencent.com/cdn/" target="_blank" rel="noopener noreferrer">CDN 控制台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。对全站开启 CDN 加速，腾讯云 CDN 配置。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/9a1591ca2dd5b80ebf8bcf641813fe8c.png" alt=""></p> <ol start="2"><li>在【缓存配置】&gt;【节点缓存过期配置】处增加以下两条规则：</li></ol> <ul><li>规则类型为【文件目录】，内容设置为 <code>/apiv3</code>，缓存选项选择【不缓存】。</li> <li>规则类型为【文件目录】，内容设置为 <code>/api</code>，缓存选项选择【不缓存】。优先级调整为“最顶部”。如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/d844a04160902335c5d8ac2a26845a01.png" alt=""></p> <ol start="3"><li>配置优先级。在缓存配置页面调整优先级为最高。如下图所示：</li></ol> <p><img src="https://main.qcloudimg.com/raw/ca305246f7c7d30018af12018e86547c.png" alt=""></p> <h4 id="cdn-打开-https-和-http2-服务"><a href="#cdn-打开-https-和-http2-服务" class="header-anchor">#</a> CDN 打开 https 和 http2 服务</h4> <p>CDN 部署后可打开 https 和 http2 服务。如下图所示：</p> <p><img src="https://main.qcloudimg.com/raw/dfcd6efd01198e39ad656c0e157e3c85.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>若您使用开源应用中心部署方式，无需进行以下配置。</p></div> <h3 id="如何快速界定性能问题"><a href="#如何快速界定性能问题" class="header-anchor">#</a> 如何快速界定性能问题？</h3> <p>目前 Discuz! Q 提供了观测接口，您可通过接口快速判断是否因为网络问题导致网站性能较差，如下图所示：</p> <ul><li>thread.list 接口 time 字段，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/2653cb8b4bb2dcbc6356aeb1b65f1dde.png" alt=""></p> <ul><li>thread.list 接口 dzq-costtime 字段，如下图所示：</li></ul> <p><img src="https://main.qcloudimg.com/raw/4d06486c92e8330d2b4a0b6c0ac41acd.png" alt=""></p> <p>上述接口中，thread.list 接口延迟是 113ms，dzq-costtime 为 93ms，实际网络传输是 20ms（113-93 = 20），可以得出如下结论：</p> <ul><li>网络比较通畅，延迟仅 20ms，如果延迟超过 100ms，需要检查网络带宽，或对网络进行性能优化。</li> <li>机器负载比较小，接口响应是 93ms，如果接口响应超过 500ms，需要检查机器负载，对机器性能进行优化。一般情况下常见的机器压力由以下几个原因导致：
<ul><li>CPU 压力过大,调整 CPU 的核心数量。</li> <li>磁盘压力过大，DiscuzQ 部署到单独的磁盘分区上，或升级 SSD。</li> <li>数据库压力过大，升级腾讯云数据库。</li></ul></li></ul> <h3 id="选用-ssd-磁盘-提升数据访问性能"><a href="#选用-ssd-磁盘-提升数据访问性能" class="header-anchor">#</a> 选用 SSD 磁盘，提升数据访问性能</h3> <p>升级为 SSD 磁盘，可以改善数据访问性能，尤其是本地缓存的访问性能，推荐个人站长将 Discuz! Q 站点所在的硬盘设置为 SSD 云硬盘，能较大提升系统性能。如下图所示：</p> <p><img src="https://main.qcloudimg.com/raw/be56646d4dd96f87737c951f1866d32a.png" alt=""></p> <p>不同类型云硬盘的性能指标可参考：<a href="https://cloud.tencent.com/document/product/362/2353#.E6.80.A7.E8.83.BD.E6.8C.87.E6.A0.87" target="_blank" rel="noopener noreferrer">性能指标<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。调整云硬盘性能详情操作参见：<a href="https://cloud.tencent.com/document/product/362/51897" target="_blank" rel="noopener noreferrer">调整云硬盘性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="php-性能优化调优"><a href="#php-性能优化调优" class="header-anchor">#</a> PHP 性能优化调优</h3> <h4 id="开启-opcache"><a href="#开启-opcache" class="header-anchor">#</a> 开启 OPcache</h4> <p>开启 OPcache 可参考：<a href="https://cloud.tencent.com/developer/article/1678575" target="_blank" rel="noopener noreferrer">使用 OPcache 提升 PHP 的性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="调优-php-进程数量"><a href="#调优-php-进程数量" class="header-anchor">#</a> 调优 PHP 进程数量</h4> <p>php-fpm 进程数可以根据服务器内存大小配置，例如，服务器内存为2G，那么可以配置1G的 PHP 进程，按照每个进程最多占用50M计算，进程数最多设置20。
进入 PHP 的安装目录，找到 <code>php-fpm.conf</code>文件，设置以下参数（如果没有这些参数可以在文件末尾进行追加）。</p> <div class="language- extra-class"><pre class="language-text"><code>pm=dynamic
pm.start_servers = 10
pm.min_spare_servers = 10
pm.max_spare_servers = 20
pm.max_requests = 100
</code></pre></div><p>通常对于 Discuz! Q 的个人站长，机器内存都比较小，建议将 <code>pm</code>  设置成  <code>dynamic</code>，并根据实际情况设置以下配置项。</p> <ul><li>start_servers： php-fpm服务启动时自动创建的进程数，建议设置最大进程数的一半即可，本示例最多进程数为20，那么 <code>start_servers</code>设置成10。</li> <li>min_spare_servers： 最小进程数，设置成 <code>start_servers</code> 相同值即可。</li> <li>max_spare_servers： 最大进程数，设置成依据内存预估的最大进程数，此处为20。</li> <li>max_requests： 请求数达到一定数值自动重启进程，避免内存泄漏，该值可依据内存大小适当配置，例如小内存机器，可适当调低该值，大内存机器可适当调高该值。</li></ul> <h4 id="升级-php-版本"><a href="#升级-php-版本" class="header-anchor">#</a> 升级 PHP 版本</h4> <p>Discuz! Q 支持的 PHP 最低版本为 <code>7.2.3</code>，对于 php8.x 的支持度暂未测试，您可以将 PHP 版本升级到 php7.x 的最小版本 <code>7.4.21</code>。</p> <h4 id="nginx-配置来提升性能"><a href="#nginx-配置来提升性能" class="header-anchor">#</a> Nginx 配置来提升性能</h4> <ul><li>gzip 压缩：<code>nginx server</code> 块中开启 gzip 压缩。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>gzip on;
 gzip_min_length 1024;
 gzip_types application/json text/css text/javascript application/x-javascript application/vnd.api+json;
 gzip_disable &quot;MSIE [1-6]\.&quot;;
 gzip_comp_level 6;
 gzip_static on;
</code></pre></div><ul><li>开启 http2： 使用 http2 会比 http/1.1 更加地高效。具体可参考：<a href="https://cloud.tencent.com/developer/article/1532739" target="_blank" rel="noopener noreferrer">HTTPS 配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>listen 443 ssl http2;
</code></pre></div><ul><li>开启缓存:详情操作可参考：<a href="https://cloud.tencent.com/developer/article/1432582" target="_blank" rel="noopener noreferrer">Nginx下关于缓存控制字段cache-control的配置说明<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>location ~ .*\.(js|css|jpg|png|svg|webp)$ {
    expires 1d;
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/使用/初次使用配置说明.html" class="prev">
        初次使用配置说明
      </a></span> <span class="next"><a href="/docs/使用/购买资源包.html">
        购买资源包
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.4a94bff3.js" defer></script><script src="/docs/assets/js/2.65b3c0ea.js" defer></script><script src="/docs/assets/js/1.93f47670.js" defer></script><script src="/docs/assets/js/29.3f95441b.js" defer></script>
  </body>
</html>
