(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{243:function(t,a,s){"use strict";s.r(a);var e=s(6),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"小程序、h5-调试说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序、h5-调试说明"}},[t._v("#")]),t._v(" 小程序、H5 调试说明")]),t._v(" "),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[t._v("本文档将对 Discuz! Q 小程序或 H5 的调试进行说明。您可参考以下内容，对小程序或H5 进行调试。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("本地调试小程序或H5，目前只支持 npm 方式构建。")])]),t._v(" "),a("h2",{attrs:{id:"前提条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[t._v("#")]),t._v(" 前提条件")]),t._v(" "),a("p",[t._v("已下载"),a("a",{attrs:{href:"1"}},[t._v("最新前端代码")]),t._v("并已执行 npm install 。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("下载代码并执行过npm install之后，先修改 .env.development 文件，将其中的服务器指向自己的Discuz! Q地址。")])]),t._v(" "),a("h3",{attrs:{id:"本地调试小程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地调试小程序"}},[t._v("#")]),t._v(" 本地调试小程序")]),t._v(" "),a("p",[t._v("可运行以下命令调试小程序：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm run dev:mp-weixin\n")])])]),a("h3",{attrs:{id:"本地调试-h5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地调试-h5"}},[t._v("#")]),t._v(" 本地调试 H5")]),t._v(" "),a("p",[t._v("可运行以下命令调试H5：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm run dev:h5\n")])])]),a("p",[t._v("调试 H5 时，由于 H5 资源来自本地，但 API 请求直接指向了远程的 Discuz! Q 地址，可能会遇到跨域访问的问题，请对Web服务器做相应的配置，允许来自 "),a("code",[t._v("http://localhost:8080")]),t._v(" 的跨域访问。比如"),a("code",[t._v("Nginx")]),t._v("下，在原来的 "),a("code",[t._v("location /")]),t._v(" 配置中，加入允许跨域的配置 ：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  add_header 'Access-Control-Allow-Origin' 'http://localhost:8080';\n  location / {\n    if ($request_method = OPTIONS ) {\n        add_header Content-Length 0;\n        add_header Content-Type text/plain;\n        add_header 'Access-Control-Allow-Methods' 'GET, POST, PATCH, DELETE, PUT, OPTIONS';\n        add_header 'Access-Control-Allow-Origin' 'http://localhost:8080';\n        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization';\n        return 200;\n    }\n    try_files $uri $uri/ /index.php?$query_string;\n  }\n")])])]),a("p",[t._v("浏览器监测到是跨域请求时，先向目标服务器发送一个 OPTIONS 请求作为跨域请求的测试(Test Flight)，这里的配置会返回给浏览器，允许来自"),a("code",[t._v("http://localhost:8080")]),t._v("的跨域请求，并允许使用 GET, POST, PATCH, DELETE, PUT, OPTIONS 等方法。")])])}),[],!1,null,null,null);a.default=r.exports}}]);